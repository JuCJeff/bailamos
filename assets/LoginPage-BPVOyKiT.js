import{j as e,a4 as _,a5 as V,a6 as U,a7 as z,a8 as B,a9 as H,aa as W,ab as $,ac as O,r as g,u as N,U as P,C as x,ad as y,ae as J,Y as M}from"./react-Cm2Y3r6B.js";import{c as p,a as v,d as X,B as w,I as h,C as q,e as I,f as D,g as R,H as Y}from"./card-zKTxpMKl.js";import{L as f,T as K,a as Q,b as F,c as C}from"./label-DhNiqzH2.js";import{k as ee,F as b,l as se,m as ae,h as re,G as te,n as ne,p as oe}from"./firebase-Coa1ixzI.js";import{aW as E}from"./vendor-DXDANXqE.js";import"./shadcn-ui-BA32w1ww.js";import"./index-nT_ByLN9.js";function ie({...s}){return e.jsx(_,{"data-slot":"dialog",...s})}function le({...s}){return e.jsx(V,{"data-slot":"dialog-trigger",...s})}function de({...s}){return e.jsx($,{"data-slot":"dialog-portal",...s})}function ce({...s}){return e.jsx(z,{"data-slot":"dialog-close",...s})}function ue({className:s,...a}){return e.jsx(O,{"data-slot":"dialog-overlay",className:p("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",s),...a})}function me({className:s,children:a,...o}){return e.jsxs(de,{"data-slot":"dialog-portal",children:[e.jsx(ue,{}),e.jsxs(U,{"data-slot":"dialog-content",className:p("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...o,children:[a,e.jsxs(z,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(B,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function L({className:s,...a}){return e.jsx("div",{"data-slot":"dialog-header",className:p("flex flex-col gap-2 text-center sm:text-left",s),...a})}function k({className:s,...a}){return e.jsx("div",{"data-slot":"dialog-footer",className:p("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...a})}function A({className:s,...a}){return e.jsx(H,{"data-slot":"dialog-title",className:p("text-lg leading-none font-semibold",s),...a})}function T({className:s,...a}){return e.jsx(W,{"data-slot":"dialog-description",className:p("text-muted-foreground text-sm",s),...a})}const S=s=>{switch(s){case"auth/email-already-in-use":return"This email is already in use. Please try another one";case"auth/weak-password":return"Password should be at least 6 characters";case"auth/user-not-found":return"No user found with this email address. Please sign up for an account";case"auth/invalid-credential":return"Invalid credentials. Please try again";case"auth/wrong-password":return"Incorrect password. Please try again";case"auth/too-many-requests":return"Too many login attempts. Please try again later";default:return"An error occurred. Please try again"}},ge=()=>{const[s,a]=g.useState(!1),[o,r]=g.useState(null),i=N();return{loading:s,error:o,handleEmailLogin:async l=>{try{const{email:n,password:t}=l,m=await(await ee(v,n,t)).user.getIdToken();E.set("auth_token",m,{expires:30,secure:!0}),i("/organizer")}catch(n){n instanceof b?(console.error("Firebase error:",n.message),r(S(n.code))):n instanceof Error?(console.error("Error:",n.message),r("An error occurred, please try again")):(console.error("An unknown error occurred",n),r("Something went wrong. Please try again later."))}finally{a(!1)}}}},xe=()=>{const[s,a]=g.useState(!1),[o,r]=g.useState(null),i=N();return{loading:s,error:o,handleEmailSignup:async l=>{a(!0),r(null);const{email:n,password:t,firstName:d,lastName:c}=l;try{const j=(await se(v,n,t)).user;await ae(re(X,"organizers",j.uid),{userId:j.uid,email:j.email,firstName:d,lastName:c,createdAt:new Date});const Z=await j.getIdToken();E.set("auth_token",Z,{expires:30}),i("/organizer")}catch(m){m instanceof b?(console.error("Firebase error:",m.message),r(S(m.code))):m instanceof Error?(console.error("Error:",m.message),r("An error occurred, please try again")):(console.error("An unknown error occurred",m),r("Something went wrong. Please try again later."))}finally{a(!1)}}}},he=()=>{const[s,a]=g.useState(!1),[o,r]=g.useState(null),[i,u]=g.useState(!1),l=N();return{loading:s,error:o,success:i,handleGoogleLogin:async()=>{a(!0),r(null);const t=new te;try{const c=(await ne(v,t)).user;if(c.uid){const j=await c.getIdToken();E.set("auth_token",j,{expires:30,secure:!0}),u(!0),l("/organizer")}}catch(d){d instanceof b?(console.error("Firebase error:",d.message),r("Failed to log in with Google, please try again")):d instanceof Error?(console.error("Error:",d.message),r("An error occurred, please try again")):(console.error("An unknown error occurred",d),r("Something went wrong. Please try again later."))}finally{a(!1)}}}},pe=()=>{const[s,a]=g.useState(null),[o,r]=g.useState(!1),i=N();return{loading:o,error:s,handlePasswordResetEmail:async l=>{const{email:n}=l;try{r(!0),a(null),await oe(v,n),i("/login")}catch(t){t instanceof b?a(S(t.code)):a("An unexpected error occurred. Please try again"),console.error("Error:",t)}finally{r(!1)}}}},fe=()=>{const{control:s,handleSubmit:a,formState:{errors:o}}=P(),{loading:r,error:i,handlePasswordResetEmail:u}=pe(),[l,n]=g.useState(!1),t=async c=>{await u(c),n(!0)},d=c=>{c.stopPropagation(),a(t)(c)};return e.jsxs(ie,{children:[e.jsx(le,{asChild:!0,children:e.jsx(w,{variant:"link",children:"Forgot your password?"})}),e.jsx(me,{className:"sm:max-w-[425px]",children:l?e.jsxs(e.Fragment,{children:[e.jsxs(L,{children:[e.jsx(A,{children:"Reset Password"}),e.jsx(T,{children:"Check your inbox for a password reset email!"})]}),e.jsx(k,{children:e.jsx(ce,{asChild:!0,children:e.jsx(w,{variant:"ghost",children:"Close"})})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(L,{children:[e.jsx(A,{children:"Reset Password"}),e.jsx(T,{children:"Enter your registered email for a password reset"})]}),e.jsxs("form",{onSubmit:d,children:[e.jsxs("div",{className:"items-center mb-4",children:[e.jsx(x,{name:"email",control:s,defaultValue:"",rules:{required:"Email is required",pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,message:"Invalid email address"}},render:({field:c})=>e.jsx(h,{...c,id:"email",placeholder:"Email"})}),o.email&&e.jsx("p",{className:"text-red-500 text-sm text-start mt-2",children:o.email.message})]}),i&&e.jsx("p",{className:"text-red-500 text-sm text-start mt-2",children:i}),e.jsx(k,{children:e.jsx(w,{type:"submit",children:r?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"animate-spin"}),"Please wait"]}):"Send Reset Email"})})]})]})})]})},je=()=>{const{control:s,handleSubmit:a,formState:{errors:o}}=P(),{loading:r,error:i,handleEmailLogin:u}=ge(),l=async n=>{await u(n)};return e.jsx("form",{onSubmit:a(l),children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"email",children:"Email"}),e.jsx(x,{name:"email",control:s,defaultValue:"",rules:{required:"Email is required",pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,message:"Invalid email address"}},render:({field:n})=>e.jsx(h,{...n,id:"email",type:"email",placeholder:"m@example.com",required:!0})}),o.email&&e.jsx("p",{className:"text-red-500 text-sm text-start",children:o.email.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{htmlFor:"password",children:"Password"}),e.jsx(fe,{})]}),e.jsx(x,{name:"password",control:s,defaultValue:"",rules:{required:"Password is required"},render:({field:n})=>e.jsx(h,{...n,id:"password",type:"password",required:!0})}),o.password&&e.jsx("p",{className:"text-red-500 text-sm text-start",children:o.password.message})]}),e.jsx(w,{type:"submit",className:"w-full",disabled:r,children:r?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"animate-spin"}),"Please wait"]}):"Login"}),i&&e.jsx("p",{className:"text-red-500 text-start mt-2",children:i})]})})},we=({...s})=>{const{theme:a="system"}=J();return e.jsx(M,{theme:a,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground font-medium",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground font-medium"}},...s})},G=()=>{const{loading:s,error:a,success:o,handleGoogleLogin:r}=he();return e.jsxs(e.Fragment,{children:[e.jsx(w,{variant:"outline",disabled:s,className:"w-full",onClick:r,children:s?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"animate-spin"}),"Please wait"]}):"Login with Google"}),e.jsx(we,{}),a&&e.jsx("p",{className:"text-red-500 text-center",children:a}),o&&e.jsx("p",{className:"text-green-500",children:"Successful! Redirecting..."})]})},Ne=({className:s,...a})=>e.jsx("div",{className:p("flex flex-col gap-6",s),...a,children:e.jsxs(q,{children:[e.jsx(I,{children:e.jsx(D,{className:"text-2xl",children:"Login"})}),e.jsxs(R,{children:[e.jsx("div",{children:e.jsx(je,{})}),e.jsx("div",{className:"mt-6",children:e.jsx(G,{})})]})]})}),ye=()=>{const{control:s,handleSubmit:a,getValues:o,formState:{errors:r}}=P(),{loading:i,error:u,handleEmailSignup:l}=xe(),n=async t=>{await l(t)};return e.jsx("form",{onSubmit:a(n),children:e.jsxs("div",{className:"w-full grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"email",children:"Email"}),e.jsx(x,{name:"email",control:s,defaultValue:"",rules:{required:"Email is required",pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,message:"Invalid email address"}},render:({field:t})=>e.jsx(h,{...t,id:"email",type:"email",placeholder:"m@example.com",required:!0})}),r.email&&e.jsx("p",{className:"text-red-500 text-sm",children:r.email.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"firstName",children:"First Name"}),e.jsx(x,{name:"firstName",control:s,render:({field:t})=>e.jsx(h,{...t,id:"firstName",type:"text",placeholder:"John",required:!0})}),r.firstName&&e.jsx("p",{className:"text-red-500 text-sm",children:r.firstName.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"lastName",children:"Last Name"}),e.jsx(x,{name:"lastName",control:s,render:({field:t})=>e.jsx(h,{...t,id:"lastName",type:"text",placeholder:"Doe",required:!0})}),r.lastName&&e.jsx("p",{className:"text-red-500 text-sm",children:r.lastName.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"password",children:"Password"}),e.jsx(x,{name:"password",control:s,defaultValue:"",rules:{required:"Password is required"},render:({field:t})=>e.jsx(h,{...t,id:"password",type:"password",required:!0})}),r.password&&e.jsx("p",{className:"text-red-500 text-sm",children:r.password.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(x,{name:"confirmPassword",control:s,defaultValue:"",rules:{required:"Please confirm your password",validate:t=>{const{password:d}=o();return t===d||"Passwords do not match"}},render:({field:t})=>e.jsx(h,{...t,id:"confirmPassword",type:"password",required:!0})}),r.confirmPassword&&e.jsx("p",{className:"text-red-500 text-sm text-start",children:r.confirmPassword.message})]}),e.jsx(w,{type:"submit",className:"w-full",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"animate-spin"}),"Please wait"]}):"Sign Up"}),u&&e.jsx("p",{className:"text-red-500 text-sm text-start mt-2",children:u})]})})},ve=({className:s,...a})=>e.jsx("div",{className:p("flex flex-col gap-6",s),...a,children:e.jsxs(q,{children:[e.jsx(I,{children:e.jsx(D,{className:"text-2xl",children:"Sign Up"})}),e.jsxs(R,{children:[e.jsx("div",{children:e.jsx(ye,{})}),e.jsx("div",{className:"mt-6",children:e.jsx(G,{})})]})]})});function be(){return e.jsx("div",{className:"flex min-h-full w-full items-center justify-center p-10 max-sm:p-4",children:e.jsx("div",{className:"w-full max-w-sm",children:e.jsxs(K,{defaultValue:"login",className:"w-full",children:[e.jsxs(Q,{className:"grid w-full grid-cols-2",children:[e.jsx(F,{value:"login",children:"Log in"}),e.jsx(F,{value:"signup",children:"Sign up"})]}),e.jsx(C,{value:"login",children:e.jsx(Ne,{})}),e.jsx(C,{value:"signup",children:e.jsx(ve,{})})]})})})}function Ae(){return e.jsxs("div",{children:[e.jsx(Y,{}),e.jsx(be,{})]})}export{Ae as default};
