import{j as e}from"./ui-vendor-CeVeEGKm.js";import{c as B,D as H,j as $,B as f,k as M,l as F,m as L,r as C,n as A,o as W,L as j,d as q,C as z,a as I,q as D,b as R,H as J}from"./card-C_iB7wo5.js";import{I as x,z as O,T as K,a as Q,b as k,c as T}from"./index-DJZcrKly.js";import{h as b,C as h}from"./form-vendor-BTvtQ4wX.js";import{r as g,u as w}from"./react-vendor-OFIyUoOe.js";import{v as X,F as N,w as Y,n as G,h as Z,G as ee,x as se,j as re,m as ae,y as te}from"./firebase-vendor-BDbcDu5O.js";import{a as y,b as P,d as _,T as ne}from"./index-KCAfwHL7.js";import"./utils-vendor-D30coVKW.js";/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],v=B("LoaderCircle",ie),S=r=>{switch(r){case"auth/email-already-in-use":return"This email is already in use. Please try another one";case"auth/weak-password":return"Password should be at least 6 characters";case"auth/user-not-found":return"No user found with this email address. Please sign up for an account";case"auth/invalid-credential":return"Invalid credentials. Please try again";case"auth/wrong-password":return"Incorrect password. Please try again";case"auth/too-many-requests":return"Too many login attempts. Please try again later";default:return"An error occurred. Please try again"}},oe=()=>{const[r,a]=g.useState(!1),[i,s]=g.useState(null),o=w();return{loading:r,error:i,handleEmailLogin:async l=>{try{const{email:n,password:t}=l,m=await(await X(y,n,t)).user.getIdToken();P.set("auth_token",m,{expires:30,secure:!0}),o("/organizer")}catch(n){n instanceof N?(console.error("Firebase error:",n.message),s(S(n.code))):n instanceof Error?(console.error("Error:",n.message),s("An error occurred, please try again")):(console.error("An unknown error occurred",n),s("Something went wrong. Please try again later."))}finally{a(!1)}}}},le=()=>{const[r,a]=g.useState(!1),[i,s]=g.useState(null),o=w();return{loading:r,error:i,handleEmailSignup:async l=>{a(!0),s(null);const{email:n,password:t,firstName:d,lastName:c}=l;try{const p=(await Y(y,n,t)).user;await G(Z(_,"organizers",p.uid),{userId:p.uid,email:p.email,firstName:d,lastName:c,createdAt:new Date});const E=await p.getIdToken();P.set("auth_token",E,{expires:30}),o("/organizer")}catch(m){m instanceof N?(console.error("Firebase error:",m.message),s(S(m.code))):m instanceof Error?(console.error("Error:",m.message),s("An error occurred, please try again")):(console.error("An unknown error occurred",m),s("Something went wrong. Please try again later."))}finally{a(!1)}}}},de=()=>{const[r,a]=g.useState(!1),[i,s]=g.useState(null),[o,u]=g.useState(!1),l=w();return{loading:r,error:i,success:o,handleGoogleLogin:async()=>{a(!0),s(null);const t=new ee;t.setCustomParameters({prompt:"select_account"});try{const c=(await se(y,t)).user,m=c.uid;if(m){const p=Z(_,"organizers",m);(await re(p)).exists()||await G(p,{userId:m,email:c.email??"",firstName:"",lastName:"",socialMediaLink:"",websiteLink:"",createdAt:ae()});const U=await c.getIdToken();P.set("auth_token",U,{expires:30,secure:!0}),u(!0),l("/organizer")}}catch(d){d instanceof N?(console.error("Firebase error:",d.message),s("Failed to log in with Google, please try again")):d instanceof Error?(console.error("Error:",d.message),s("An error occurred, please try again")):(console.error("An unknown error occurred",d),s("Something went wrong. Please try again later."))}finally{a(!1)}}}},ce=()=>{const[r,a]=g.useState(null),[i,s]=g.useState(!1),o=w();return{loading:i,error:r,handlePasswordResetEmail:async l=>{const{email:n}=l;try{s(!0),a(null),await te(y,n),o("/login")}catch(t){t instanceof N?a(S(t.code)):a("An unexpected error occurred. Please try again"),console.error("Error:",t)}finally{s(!1)}}}},me=()=>{const{control:r,handleSubmit:a,formState:{errors:i}}=b(),{loading:s,error:o,handlePasswordResetEmail:u}=ce(),[l,n]=g.useState(!1),t=async c=>{await u(c),n(!0)},d=c=>{c.stopPropagation(),a(t)(c)};return e.jsxs(H,{children:[e.jsx($,{asChild:!0,children:e.jsx(f,{variant:"link",children:"Forgot your password?"})}),e.jsx(M,{className:"sm:max-w-[425px]",children:l?e.jsxs(e.Fragment,{children:[e.jsxs(F,{children:[e.jsx(L,{children:"Reset Password"}),e.jsx(C,{children:"Check your inbox for a password reset email!"})]}),e.jsx(A,{children:e.jsx(W,{asChild:!0,children:e.jsx(f,{variant:"ghost",children:"Close"})})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(F,{children:[e.jsx(L,{children:"Reset Password"}),e.jsx(C,{children:"Enter your registered email for a password reset"})]}),e.jsxs("form",{onSubmit:d,children:[e.jsxs("div",{className:"items-center mb-4",children:[e.jsx(h,{name:"email",control:r,defaultValue:"",rules:{required:"Email is required",pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,message:"Invalid email address"}},render:({field:c})=>e.jsx(x,{...c,id:"email",placeholder:"Email"})}),i.email&&e.jsx("p",{className:"text-red-500 text-sm text-start mt-2",children:i.email.message})]}),o&&e.jsx("p",{className:"text-red-500 text-sm text-start mt-2",children:o}),e.jsx(A,{children:e.jsx(f,{type:"submit",children:s?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"animate-spin"}),"Please wait"]}):"Send Reset Email"})})]})]})})]})},ue=()=>{const{control:r,handleSubmit:a,formState:{errors:i}}=b(),{loading:s,error:o,handleEmailLogin:u}=oe(),l=async n=>{await u(n)};return e.jsx("form",{onSubmit:a(l),children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"email",children:"Email"}),e.jsx(h,{name:"email",control:r,defaultValue:"",rules:{required:"Email is required",pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,message:"Invalid email address"}},render:({field:n})=>e.jsx(x,{...n,id:"email",type:"email",placeholder:"m@example.com",required:!0})}),i.email&&e.jsx("p",{className:"text-red-500 text-sm text-start",children:i.email.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(j,{htmlFor:"password",children:"Password"}),e.jsx(me,{})]}),e.jsx(h,{name:"password",control:r,defaultValue:"",rules:{required:"Password is required"},render:({field:n})=>e.jsx(x,{...n,id:"password",type:"password",required:!0})}),i.password&&e.jsx("p",{className:"text-red-500 text-sm text-start",children:i.password.message})]}),e.jsx(f,{type:"submit",className:"w-full",disabled:s,children:s?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"animate-spin"}),"Please wait"]}):"Login"}),o&&e.jsx("p",{className:"text-red-500 text-start mt-2",children:o})]})})},ge=({...r})=>{const{theme:a="system"}=O();return e.jsx(ne,{theme:a,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground font-medium",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground font-medium"}},...r})},V=()=>{const{loading:r,error:a,success:i,handleGoogleLogin:s}=de();return e.jsxs(e.Fragment,{children:[e.jsx(f,{variant:"outline",disabled:r,className:"w-full",onClick:s,children:r?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"animate-spin"}),"Please wait"]}):"Login with Google"}),e.jsx(ge,{}),a&&e.jsx("p",{className:"text-red-500 text-center",children:a}),i&&e.jsx("p",{className:"text-green-500",children:"Successful! Redirecting..."})]})},xe=({className:r,...a})=>e.jsx("div",{className:q("flex flex-col gap-6",r),...a,children:e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(D,{className:"text-2xl",children:"Login"})}),e.jsxs(R,{children:[e.jsx("div",{children:e.jsx(ue,{})}),e.jsx("div",{className:"mt-6",children:e.jsx(V,{})})]})]})}),he=()=>{const{control:r,handleSubmit:a,getValues:i,formState:{errors:s}}=b(),{loading:o,error:u,handleEmailSignup:l}=le(),n=async t=>{await l(t)};return e.jsx("form",{onSubmit:a(n),children:e.jsxs("div",{className:"w-full grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"email",children:"Email"}),e.jsx(h,{name:"email",control:r,defaultValue:"",rules:{required:"Email is required",pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,message:"Invalid email address"}},render:({field:t})=>e.jsx(x,{...t,id:"email",type:"email",placeholder:"m@example.com",required:!0})}),s.email&&e.jsx("p",{className:"text-red-500 text-sm",children:s.email.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"firstName",children:"First Name"}),e.jsx(h,{name:"firstName",control:r,render:({field:t})=>e.jsx(x,{...t,id:"firstName",type:"text",placeholder:"John",required:!0})}),s.firstName&&e.jsx("p",{className:"text-red-500 text-sm",children:s.firstName.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"lastName",children:"Last Name"}),e.jsx(h,{name:"lastName",control:r,render:({field:t})=>e.jsx(x,{...t,id:"lastName",type:"text",placeholder:"Doe",required:!0})}),s.lastName&&e.jsx("p",{className:"text-red-500 text-sm",children:s.lastName.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"password",children:"Password"}),e.jsx(h,{name:"password",control:r,defaultValue:"",rules:{required:"Password is required"},render:({field:t})=>e.jsx(x,{...t,id:"password",type:"password",required:!0})}),s.password&&e.jsx("p",{className:"text-red-500 text-sm",children:s.password.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(h,{name:"confirmPassword",control:r,defaultValue:"",rules:{required:"Please confirm your password",validate:t=>{const{password:d}=i();return t===d||"Passwords do not match"}},render:({field:t})=>e.jsx(x,{...t,id:"confirmPassword",type:"password",required:!0})}),s.confirmPassword&&e.jsx("p",{className:"text-red-500 text-sm text-start",children:s.confirmPassword.message})]}),e.jsx(f,{type:"submit",className:"w-full",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"animate-spin"}),"Please wait"]}):"Sign Up"}),u&&e.jsx("p",{className:"text-red-500 text-sm text-start mt-2",children:u})]})})},pe=({className:r,...a})=>e.jsx("div",{className:q("flex flex-col gap-6",r),...a,children:e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(D,{className:"text-2xl",children:"Sign Up"})}),e.jsxs(R,{children:[e.jsx("div",{children:e.jsx(he,{})}),e.jsx("div",{className:"mt-6",children:e.jsx(V,{})})]})]})});function je(){return e.jsx("div",{className:"flex min-h-full w-full items-center justify-center p-10 max-sm:p-4",children:e.jsx("div",{className:"w-full max-w-sm",children:e.jsxs(K,{defaultValue:"login",className:"w-full",children:[e.jsxs(Q,{className:"grid w-full grid-cols-2",children:[e.jsx(k,{value:"login",children:"Log in"}),e.jsx(k,{value:"signup",children:"Sign up"})]}),e.jsx(T,{value:"login",children:e.jsx(xe,{})}),e.jsx(T,{value:"signup",children:e.jsx(pe,{})})]})})})}function Ee(){return e.jsxs("div",{children:[e.jsx(J,{}),e.jsx(je,{})]})}export{Ee as default};
