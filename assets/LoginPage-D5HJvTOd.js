import{r as g,u as w,Q as P,j as e,C as x,Y as N,Z as G,T as V}from"./react-BVI_gf1o.js";import{a as y,d as U,B as f,I as h,c as q,C as k,e as I,f as z,g as D,H as _}from"./card-FOHKPLy3.js";import{D as B,a as H,b as $,c as S,d as F,g as L,e as A,f as W,L as p,T as J,h as M,i as C,j as T}from"./dialog-DLKrukMQ.js";import{l as O,F as v,m as Q,f as Y,d as K,G as X,n as ee,p as se}from"./firebase-Ce7PeUJe.js";import{U as b}from"./vendor-DCPdCeUv.js";import"./shadcn-ui-BA32w1ww.js";import"./index-BYc30wNZ.js";const E=r=>{switch(r){case"auth/email-already-in-use":return"This email is already in use. Please try another one";case"auth/weak-password":return"Password should be at least 6 characters";case"auth/user-not-found":return"No user found with this email address. Please sign up for an account";case"auth/invalid-credential":return"Invalid credentials. Please try again";case"auth/wrong-password":return"Incorrect password. Please try again";case"auth/too-many-requests":return"Too many login attempts. Please try again later";default:return"An error occurred. Please try again"}},re=()=>{const[r,a]=g.useState(!1),[i,s]=g.useState(null),o=w();return{loading:r,error:i,handleEmailLogin:async l=>{try{const{email:n,password:t}=l,u=await(await O(y,n,t)).user.getIdToken();b.set("auth_token",u,{expires:30,secure:!0}),o("/organizer")}catch(n){n instanceof v?(console.error("Firebase error:",n.message),s(E(n.code))):n instanceof Error?(console.error("Error:",n.message),s("An error occurred, please try again")):(console.error("An unknown error occurred",n),s("Something went wrong. Please try again later."))}finally{a(!1)}}}},ae=()=>{const[r,a]=g.useState(!1),[i,s]=g.useState(null),o=w();return{loading:r,error:i,handleEmailSignup:async l=>{a(!0),s(null);const{email:n,password:t,firstName:d,lastName:c}=l;try{const j=(await Q(y,n,t)).user;await Y(K(U,"organizers",j.uid),{userId:j.uid,email:j.email,firstName:d,lastName:c,createdAt:new Date});const Z=await j.getIdToken();b.set("auth_token",Z,{expires:30}),o("/organizer")}catch(u){u instanceof v?(console.error("Firebase error:",u.message),s(E(u.code))):u instanceof Error?(console.error("Error:",u.message),s("An error occurred, please try again")):(console.error("An unknown error occurred",u),s("Something went wrong. Please try again later."))}finally{a(!1)}}}},te=()=>{const[r,a]=g.useState(!1),[i,s]=g.useState(null),[o,m]=g.useState(!1),l=w();return{loading:r,error:i,success:o,handleGoogleLogin:async()=>{a(!0),s(null);const t=new X;try{const c=(await ee(y,t)).user;if(c.uid){const j=await c.getIdToken();b.set("auth_token",j,{expires:30,secure:!0}),m(!0),l("/organizer")}}catch(d){d instanceof v?(console.error("Firebase error:",d.message),s("Failed to log in with Google, please try again")):d instanceof Error?(console.error("Error:",d.message),s("An error occurred, please try again")):(console.error("An unknown error occurred",d),s("Something went wrong. Please try again later."))}finally{a(!1)}}}},ne=()=>{const[r,a]=g.useState(null),[i,s]=g.useState(!1),o=w();return{loading:i,error:r,handlePasswordResetEmail:async l=>{const{email:n}=l;try{s(!0),a(null),await se(y,n),o("/login")}catch(t){t instanceof v?a(E(t.code)):a("An unexpected error occurred. Please try again"),console.error("Error:",t)}finally{s(!1)}}}},ie=()=>{const{control:r,handleSubmit:a,formState:{errors:i}}=P(),{loading:s,error:o,handlePasswordResetEmail:m}=ne(),[l,n]=g.useState(!1),t=async c=>{await m(c),n(!0)},d=c=>{c.stopPropagation(),a(t)(c)};return e.jsxs(B,{children:[e.jsx(H,{asChild:!0,children:e.jsx(f,{variant:"link",children:"Forgot your password?"})}),e.jsx($,{className:"sm:max-w-[425px]",children:l?e.jsxs(e.Fragment,{children:[e.jsxs(S,{children:[e.jsx(F,{children:"Reset Password"}),e.jsx(L,{children:"Check your inbox for a password reset email!"})]}),e.jsx(A,{children:e.jsx(W,{asChild:!0,children:e.jsx(f,{variant:"ghost",children:"Close"})})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(S,{children:[e.jsx(F,{children:"Reset Password"}),e.jsx(L,{children:"Enter your registered email for a password reset"})]}),e.jsxs("form",{onSubmit:d,children:[e.jsxs("div",{className:"items-center mb-4",children:[e.jsx(x,{name:"email",control:r,defaultValue:"",rules:{required:"Email is required",pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,message:"Invalid email address"}},render:({field:c})=>e.jsx(h,{...c,id:"email",placeholder:"Email"})}),i.email&&e.jsx("p",{className:"text-red-500 text-sm text-start mt-2",children:i.email.message})]}),o&&e.jsx("p",{className:"text-red-500 text-sm text-start mt-2",children:o}),e.jsx(A,{children:e.jsx(f,{type:"submit",children:s?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"animate-spin"}),"Please wait"]}):"Send Reset Email"})})]})]})})]})},oe=()=>{const{control:r,handleSubmit:a,formState:{errors:i}}=P(),{loading:s,error:o,handleEmailLogin:m}=re(),l=async n=>{await m(n)};return e.jsx("form",{onSubmit:a(l),children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"email",children:"Email"}),e.jsx(x,{name:"email",control:r,defaultValue:"",rules:{required:"Email is required",pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,message:"Invalid email address"}},render:({field:n})=>e.jsx(h,{...n,id:"email",type:"email",placeholder:"m@example.com",required:!0})}),i.email&&e.jsx("p",{className:"text-red-500 text-sm text-start",children:i.email.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(p,{htmlFor:"password",children:"Password"}),e.jsx(ie,{})]}),e.jsx(x,{name:"password",control:r,defaultValue:"",rules:{required:"Password is required"},render:({field:n})=>e.jsx(h,{...n,id:"password",type:"password",required:!0})}),i.password&&e.jsx("p",{className:"text-red-500 text-sm text-start",children:i.password.message})]}),e.jsx(f,{type:"submit",className:"w-full",disabled:s,children:s?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"animate-spin"}),"Please wait"]}):"Login"}),o&&e.jsx("p",{className:"text-red-500 text-start mt-2",children:o})]})})},le=({...r})=>{const{theme:a="system"}=G();return e.jsx(V,{theme:a,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground font-medium",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground font-medium"}},...r})},R=()=>{const{loading:r,error:a,success:i,handleGoogleLogin:s}=te();return e.jsxs(e.Fragment,{children:[e.jsx(f,{variant:"outline",disabled:r,className:"w-full",onClick:s,children:r?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"animate-spin"}),"Please wait"]}):"Login with Google"}),e.jsx(le,{}),a&&e.jsx("p",{className:"text-red-500 text-center",children:a}),i&&e.jsx("p",{className:"text-green-500",children:"Successful! Redirecting..."})]})},de=({className:r,...a})=>e.jsx("div",{className:q("flex flex-col gap-6",r),...a,children:e.jsxs(k,{children:[e.jsx(I,{children:e.jsx(z,{className:"text-2xl",children:"Login"})}),e.jsxs(D,{children:[e.jsx("div",{children:e.jsx(oe,{})}),e.jsx("div",{className:"mt-6",children:e.jsx(R,{})})]})]})}),ce=()=>{const{control:r,handleSubmit:a,getValues:i,formState:{errors:s}}=P(),{loading:o,error:m,handleEmailSignup:l}=ae(),n=async t=>{await l(t)};return e.jsx("form",{onSubmit:a(n),children:e.jsxs("div",{className:"w-full grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"email",children:"Email"}),e.jsx(x,{name:"email",control:r,defaultValue:"",rules:{required:"Email is required",pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,message:"Invalid email address"}},render:({field:t})=>e.jsx(h,{...t,id:"email",type:"email",placeholder:"m@example.com",required:!0})}),s.email&&e.jsx("p",{className:"text-red-500 text-sm",children:s.email.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"firstName",children:"First Name"}),e.jsx(x,{name:"firstName",control:r,render:({field:t})=>e.jsx(h,{...t,id:"firstName",type:"text",placeholder:"John",required:!0})}),s.firstName&&e.jsx("p",{className:"text-red-500 text-sm",children:s.firstName.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"lastName",children:"Last Name"}),e.jsx(x,{name:"lastName",control:r,render:({field:t})=>e.jsx(h,{...t,id:"lastName",type:"text",placeholder:"Doe",required:!0})}),s.lastName&&e.jsx("p",{className:"text-red-500 text-sm",children:s.lastName.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"password",children:"Password"}),e.jsx(x,{name:"password",control:r,defaultValue:"",rules:{required:"Password is required"},render:({field:t})=>e.jsx(h,{...t,id:"password",type:"password",required:!0})}),s.password&&e.jsx("p",{className:"text-red-500 text-sm",children:s.password.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(x,{name:"confirmPassword",control:r,defaultValue:"",rules:{required:"Please confirm your password",validate:t=>{const{password:d}=i();return t===d||"Passwords do not match"}},render:({field:t})=>e.jsx(h,{...t,id:"confirmPassword",type:"password",required:!0})}),s.confirmPassword&&e.jsx("p",{className:"text-red-500 text-sm text-start",children:s.confirmPassword.message})]}),e.jsx(f,{type:"submit",className:"w-full",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"animate-spin"}),"Please wait"]}):"Sign Up"}),m&&e.jsx("p",{className:"text-red-500 text-sm text-start mt-2",children:m})]})})},me=({className:r,...a})=>e.jsx("div",{className:q("flex flex-col gap-6",r),...a,children:e.jsxs(k,{children:[e.jsx(I,{children:e.jsx(z,{className:"text-2xl",children:"Sign Up"})}),e.jsxs(D,{children:[e.jsx("div",{children:e.jsx(ce,{})}),e.jsx("div",{className:"mt-6",children:e.jsx(R,{})})]})]})});function ue(){return e.jsx("div",{className:"flex min-h-full w-full items-center justify-center p-10 max-sm:p-4",children:e.jsx("div",{className:"w-full max-w-sm",children:e.jsxs(J,{defaultValue:"login",className:"w-full",children:[e.jsxs(M,{className:"grid w-full grid-cols-2",children:[e.jsx(C,{value:"login",children:"Log in"}),e.jsx(C,{value:"signup",children:"Sign up"})]}),e.jsx(T,{value:"login",children:e.jsx(de,{})}),e.jsx(T,{value:"signup",children:e.jsx(me,{})})]})})})}function Ne(){return e.jsxs("div",{children:[e.jsx(_,{}),e.jsx(ue,{})]})}export{Ne as default};
