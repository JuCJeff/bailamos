import{r as g,u as w,w as P,j as e,C as x,L as N,A as B,T as H}from"./react-GXTH3AUW.js";import{D as $,g as W,B as f,h as M,i as F,j as L,p as A,k as C,l as J,L as j,c as q,C as z,m as I,n as D,o as R,H as O}from"./card-CMZodUuv.js";import{I as h,T as K,a as Q,b as k,c as T}from"./input-CtR6lZbr.js";import{t as X,F as y,v as Y,l as G,e as Z,G as ee,w as se,f as re,k as ae,x as te}from"./firebase-nofmxHfp.js";import{U as S}from"./vendor-BDfBbFA7.js";import{a as v,d as V}from"./index-DdTYszON.js";import"./shadcn-ui-BA32w1ww.js";const b=r=>{switch(r){case"auth/email-already-in-use":return"This email is already in use. Please try another one";case"auth/weak-password":return"Password should be at least 6 characters";case"auth/user-not-found":return"No user found with this email address. Please sign up for an account";case"auth/invalid-credential":return"Invalid credentials. Please try again";case"auth/wrong-password":return"Incorrect password. Please try again";case"auth/too-many-requests":return"Too many login attempts. Please try again later";default:return"An error occurred. Please try again"}},ne=()=>{const[r,a]=g.useState(!1),[i,s]=g.useState(null),o=w();return{loading:r,error:i,handleEmailLogin:async l=>{try{const{email:n,password:t}=l,m=await(await X(v,n,t)).user.getIdToken();S.set("auth_token",m,{expires:30,secure:!0}),o("/organizer")}catch(n){n instanceof y?(console.error("Firebase error:",n.message),s(b(n.code))):n instanceof Error?(console.error("Error:",n.message),s("An error occurred, please try again")):(console.error("An unknown error occurred",n),s("Something went wrong. Please try again later."))}finally{a(!1)}}}},ie=()=>{const[r,a]=g.useState(!1),[i,s]=g.useState(null),o=w();return{loading:r,error:i,handleEmailSignup:async l=>{a(!0),s(null);const{email:n,password:t,firstName:d,lastName:c}=l;try{const p=(await Y(v,n,t)).user;await G(Z(V,"organizers",p.uid),{userId:p.uid,email:p.email,firstName:d,lastName:c,createdAt:new Date});const E=await p.getIdToken();S.set("auth_token",E,{expires:30}),o("/organizer")}catch(m){m instanceof y?(console.error("Firebase error:",m.message),s(b(m.code))):m instanceof Error?(console.error("Error:",m.message),s("An error occurred, please try again")):(console.error("An unknown error occurred",m),s("Something went wrong. Please try again later."))}finally{a(!1)}}}},oe=()=>{const[r,a]=g.useState(!1),[i,s]=g.useState(null),[o,u]=g.useState(!1),l=w();return{loading:r,error:i,success:o,handleGoogleLogin:async()=>{a(!0),s(null);const t=new ee;t.setCustomParameters({prompt:"select_account"});try{const c=(await se(v,t)).user,m=c.uid;if(m){const p=Z(V,"organizers",m);(await re(p)).exists()||await G(p,{userId:m,email:c.email??"",firstName:"",lastName:"",socialMediaLink:"",websiteLink:"",createdAt:ae()});const _=await c.getIdToken();S.set("auth_token",_,{expires:30,secure:!0}),u(!0),l("/organizer")}}catch(d){d instanceof y?(console.error("Firebase error:",d.message),s("Failed to log in with Google, please try again")):d instanceof Error?(console.error("Error:",d.message),s("An error occurred, please try again")):(console.error("An unknown error occurred",d),s("Something went wrong. Please try again later."))}finally{a(!1)}}}},le=()=>{const[r,a]=g.useState(null),[i,s]=g.useState(!1),o=w();return{loading:i,error:r,handlePasswordResetEmail:async l=>{const{email:n}=l;try{s(!0),a(null),await te(v,n),o("/login")}catch(t){t instanceof y?a(b(t.code)):a("An unexpected error occurred. Please try again"),console.error("Error:",t)}finally{s(!1)}}}},de=()=>{const{control:r,handleSubmit:a,formState:{errors:i}}=P(),{loading:s,error:o,handlePasswordResetEmail:u}=le(),[l,n]=g.useState(!1),t=async c=>{await u(c),n(!0)},d=c=>{c.stopPropagation(),a(t)(c)};return e.jsxs($,{children:[e.jsx(W,{asChild:!0,children:e.jsx(f,{variant:"link",children:"Forgot your password?"})}),e.jsx(M,{className:"sm:max-w-[425px]",children:l?e.jsxs(e.Fragment,{children:[e.jsxs(F,{children:[e.jsx(L,{children:"Reset Password"}),e.jsx(A,{children:"Check your inbox for a password reset email!"})]}),e.jsx(C,{children:e.jsx(J,{asChild:!0,children:e.jsx(f,{variant:"ghost",children:"Close"})})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(F,{children:[e.jsx(L,{children:"Reset Password"}),e.jsx(A,{children:"Enter your registered email for a password reset"})]}),e.jsxs("form",{onSubmit:d,children:[e.jsxs("div",{className:"items-center mb-4",children:[e.jsx(x,{name:"email",control:r,defaultValue:"",rules:{required:"Email is required",pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,message:"Invalid email address"}},render:({field:c})=>e.jsx(h,{...c,id:"email",placeholder:"Email"})}),i.email&&e.jsx("p",{className:"text-red-500 text-sm text-start mt-2",children:i.email.message})]}),o&&e.jsx("p",{className:"text-red-500 text-sm text-start mt-2",children:o}),e.jsx(C,{children:e.jsx(f,{type:"submit",children:s?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"animate-spin"}),"Please wait"]}):"Send Reset Email"})})]})]})})]})},ce=()=>{const{control:r,handleSubmit:a,formState:{errors:i}}=P(),{loading:s,error:o,handleEmailLogin:u}=ne(),l=async n=>{await u(n)};return e.jsx("form",{onSubmit:a(l),children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"email",children:"Email"}),e.jsx(x,{name:"email",control:r,defaultValue:"",rules:{required:"Email is required",pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,message:"Invalid email address"}},render:({field:n})=>e.jsx(h,{...n,id:"email",type:"email",placeholder:"m@example.com",required:!0})}),i.email&&e.jsx("p",{className:"text-red-500 text-sm text-start",children:i.email.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(j,{htmlFor:"password",children:"Password"}),e.jsx(de,{})]}),e.jsx(x,{name:"password",control:r,defaultValue:"",rules:{required:"Password is required"},render:({field:n})=>e.jsx(h,{...n,id:"password",type:"password",required:!0})}),i.password&&e.jsx("p",{className:"text-red-500 text-sm text-start",children:i.password.message})]}),e.jsx(f,{type:"submit",className:"w-full",disabled:s,children:s?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"animate-spin"}),"Please wait"]}):"Login"}),o&&e.jsx("p",{className:"text-red-500 text-start mt-2",children:o})]})})},me=({...r})=>{const{theme:a="system"}=B();return e.jsx(H,{theme:a,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground font-medium",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground font-medium"}},...r})},U=()=>{const{loading:r,error:a,success:i,handleGoogleLogin:s}=oe();return e.jsxs(e.Fragment,{children:[e.jsx(f,{variant:"outline",disabled:r,className:"w-full",onClick:s,children:r?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"animate-spin"}),"Please wait"]}):"Login with Google"}),e.jsx(me,{}),a&&e.jsx("p",{className:"text-red-500 text-center",children:a}),i&&e.jsx("p",{className:"text-green-500",children:"Successful! Redirecting..."})]})},ue=({className:r,...a})=>e.jsx("div",{className:q("flex flex-col gap-6",r),...a,children:e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(D,{className:"text-2xl",children:"Login"})}),e.jsxs(R,{children:[e.jsx("div",{children:e.jsx(ce,{})}),e.jsx("div",{className:"mt-6",children:e.jsx(U,{})})]})]})}),ge=()=>{const{control:r,handleSubmit:a,getValues:i,formState:{errors:s}}=P(),{loading:o,error:u,handleEmailSignup:l}=ie(),n=async t=>{await l(t)};return e.jsx("form",{onSubmit:a(n),children:e.jsxs("div",{className:"w-full grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"email",children:"Email"}),e.jsx(x,{name:"email",control:r,defaultValue:"",rules:{required:"Email is required",pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,message:"Invalid email address"}},render:({field:t})=>e.jsx(h,{...t,id:"email",type:"email",placeholder:"m@example.com",required:!0})}),s.email&&e.jsx("p",{className:"text-red-500 text-sm",children:s.email.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"firstName",children:"First Name"}),e.jsx(x,{name:"firstName",control:r,render:({field:t})=>e.jsx(h,{...t,id:"firstName",type:"text",placeholder:"John",required:!0})}),s.firstName&&e.jsx("p",{className:"text-red-500 text-sm",children:s.firstName.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"lastName",children:"Last Name"}),e.jsx(x,{name:"lastName",control:r,render:({field:t})=>e.jsx(h,{...t,id:"lastName",type:"text",placeholder:"Doe",required:!0})}),s.lastName&&e.jsx("p",{className:"text-red-500 text-sm",children:s.lastName.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"password",children:"Password"}),e.jsx(x,{name:"password",control:r,defaultValue:"",rules:{required:"Password is required"},render:({field:t})=>e.jsx(h,{...t,id:"password",type:"password",required:!0})}),s.password&&e.jsx("p",{className:"text-red-500 text-sm",children:s.password.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(x,{name:"confirmPassword",control:r,defaultValue:"",rules:{required:"Please confirm your password",validate:t=>{const{password:d}=i();return t===d||"Passwords do not match"}},render:({field:t})=>e.jsx(h,{...t,id:"confirmPassword",type:"password",required:!0})}),s.confirmPassword&&e.jsx("p",{className:"text-red-500 text-sm text-start",children:s.confirmPassword.message})]}),e.jsx(f,{type:"submit",className:"w-full",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"animate-spin"}),"Please wait"]}):"Sign Up"}),u&&e.jsx("p",{className:"text-red-500 text-sm text-start mt-2",children:u})]})})},xe=({className:r,...a})=>e.jsx("div",{className:q("flex flex-col gap-6",r),...a,children:e.jsxs(z,{children:[e.jsx(I,{children:e.jsx(D,{className:"text-2xl",children:"Sign Up"})}),e.jsxs(R,{children:[e.jsx("div",{children:e.jsx(ge,{})}),e.jsx("div",{className:"mt-6",children:e.jsx(U,{})})]})]})});function he(){return e.jsx("div",{className:"flex min-h-full w-full items-center justify-center p-10 max-sm:p-4",children:e.jsx("div",{className:"w-full max-w-sm",children:e.jsxs(K,{defaultValue:"login",className:"w-full",children:[e.jsxs(Q,{className:"grid w-full grid-cols-2",children:[e.jsx(k,{value:"login",children:"Log in"}),e.jsx(k,{value:"signup",children:"Sign up"})]}),e.jsx(T,{value:"login",children:e.jsx(ue,{})}),e.jsx(T,{value:"signup",children:e.jsx(xe,{})})]})})})}function Pe(){return e.jsxs("div",{children:[e.jsx(O,{}),e.jsx(he,{})]})}export{Pe as default};
