import{u as me,j as e,F as we,r as x,C as q,S as Ne,d as X,e as Ce,I as Se,f as ke,g as Pe,h as xe,i as Z,D as Fe,k as Ee,l as ze,m as Le,n as Te,P as De,o as _e,p as Me,V as Ue,q as Ie,s as Re,t as Oe,v as Ve,w as Ae,x as $e,y as he,z as He,A as Be,E as qe,G as We,H as Ke,J as Ge,K as Je,L as Qe,M as Ye,N as Xe,O as Ze,Q as et,U as tt,W as E,T as st}from"./react-Atwg6Y4L.js";import{U as A,V as p,E as at,y as rt}from"./vendor-C1jyi8n5.js";import{a as _,B as b,c as v,b as le,d as k,C as ee,e as te,f as se,g as ae,s as nt,h as ot,H as it}from"./card-DyGAmpAP.js";import{s as lt,o as ct,d as z,a as re,u as dt,r as ut,b as mt,e as xt,c as fe,f as ht,h as O,i as ft,q as gt,j as pt,g as jt,k as ce}from"./firebase-Dd6tnWe6.js";import{L as vt,I as M,D as W,a as K,b as G,c as J,d as Q,e as ge,f as bt,g as yt,T as wt,h as Nt,i as $,j as H}from"./dialog-DcPkySdG.js";import{u as Ct,A as St,G as kt,M as Pt,I as Ft}from"./google-maps-9peLr9on.js";import{m as Et,e as zt,a as R,E as pe}from"./EventCard-DJq4Hrfh.js";import"./shadcn-ui-BA32w1ww.js";import"./index-S9GNv4xF.js";const Lt=()=>{const t=me();return{handleSignOut:async()=>{try{const s=await lt(_);console.log(s),A.remove("auth_token"),t("/login")}catch(s){console.error("Error during sign out: ",s)}}}},Tt=()=>{const{handleSignOut:t}=Lt();return e.jsx(b,{onClick:t,children:"Log out"})},Dt=we,je=x.createContext({}),D=({...t})=>e.jsx(je.Provider,{value:{name:t.name},children:e.jsx(q,{...t})}),ne=()=>{const t=x.useContext(je),a=x.useContext(ve),{getFieldState:s}=X(),d=Ce({name:t.name}),l=s(t.name,d);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:c}=a;return{id:c,name:t.name,formItemId:`${c}-form-item`,formDescriptionId:`${c}-form-item-description`,formMessageId:`${c}-form-item-message`,...l}},ve=x.createContext({});function S({className:t,...a}){const s=x.useId();return e.jsx(ve.Provider,{value:{id:s},children:e.jsx("div",{"data-slot":"form-item",className:v("grid gap-2",t),...a})})}function C({className:t,...a}){const{error:s,formItemId:d}=ne();return e.jsx(vt,{"data-slot":"form-label","data-error":!!s,className:v("data-[error=true]:text-destructive",t),htmlFor:d,...a})}function L({...t}){const{error:a,formItemId:s,formDescriptionId:d,formMessageId:l}=ne();return e.jsx(Ne,{"data-slot":"form-control",id:s,"aria-describedby":a?`${d} ${l}`:`${d}`,"aria-invalid":!!a,...t})}function P({className:t,...a}){const{error:s,formMessageId:d}=ne(),l=s?String((s==null?void 0:s.message)??""):a.children;return l?e.jsx("p",{"data-slot":"form-message",id:d,className:v("text-destructive text-sm",t),...a,children:l}):null}function _t({className:t,...a}){return e.jsx("textarea",{"data-slot":"textarea",className:v("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}const de=p.object({name:p.string(),percentage:p.number().max(100,"Percentage cannot exceed 100%")}),Mt=p.object({title:p.string().min(3,"Title is required"),startTime:p.date({required_error:"A start date and time is required"}),endTime:p.date({required_error:"An end date and time is required"}),price:p.number(),description:p.string().optional(),image:p.instanceof(File).optional(),link:p.string().optional(),eventTags:p.array(p.string()).optional(),music:p.array(p.string()).nonempty("Select at least one category"),musicPercentages:p.record(p.string(),de).and(p.object({others:de}).optional()).refine(t=>Object.values(t).reduce((a,s)=>a+s.percentage,0)<=100,{message:"Total music percentages cannot exceed 100%"}),location:p.object({propertyName:p.string().optional(),address:p.string().optional(),city:p.string().optional(),state:p.string().optional(),googleMapsUrl:p.string().optional(),lat:p.number().optional(),lng:p.number().optional()}).optional()}),Ut=({control:t,name:a})=>e.jsx(D,{control:t,name:a,render:({field:s})=>e.jsxs(S,{children:[e.jsx(C,{htmlFor:"imageUpload",children:"Upload Image"}),e.jsx(L,{children:e.jsx(It,{id:"imageUpload",value:s.value||void 0,onChange:s.onChange})}),e.jsx(P,{})]})}),It=({id:t,value:a,onChange:s})=>{const[d,l]=x.useState(null),c=x.useRef(null);x.useEffect(()=>{if(a instanceof File){const r=URL.createObjectURL(a);return l(r),()=>URL.revokeObjectURL(r)}else l(null)},[a]);const n=r=>{var h;const i=(h=r[0])==null?void 0:h.file;i instanceof File?s(i):(console.warn("Selected image is not a valid File object"),s(void 0))};return e.jsx(Se,{multiple:!1,value:a?[{file:a,data_url:d??""}]:[],onChange:n,dataURLKey:"data_url",children:({onImageUpload:r,onImageUpdate:i,onImageRemove:h,isDragging:u,dragProps:o})=>e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("input",{id:t,type:"file",ref:c,className:"hidden",onChange:m=>{var f;const g=(f=m.target.files)==null?void 0:f[0];g instanceof File&&s(g)}}),e.jsx(b,{type:"button",style:u?{backgroundColor:"limegreen",transition:"0.25s"}:void 0,onClick:r,...o,children:"Click or Drop image here"}),d&&e.jsxs("div",{children:[e.jsx("img",{src:d,alt:"event preview",className:"rounded-2xl"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(b,{type:"button",onClick:()=>i(0),children:"Update"}),e.jsx(b,{type:"button",onClick:()=>h(0),children:"Remove"})]})]})]})})},Rt=["places","marker"],I={lat:43.0722,lng:-89.4008},Ot=({control:t,name:a})=>{const[s,d]=x.useState(null),[l,c]=x.useState(!1),[n,r]=x.useState(I),i=x.useRef(null),{isLoaded:h}=Ct({googleMapsApiKey:"AIzaSyBuImOK6KWeeg3f71cgw6R-ssJj4arkAjk",libraries:Rt}),u=o=>{var w,T,j,N,F;if(!i.current)return;const m=i.current.getPlace();if(!((w=m.geometry)!=null&&w.location))return;const g=m.geometry.location.lat(),f=m.geometry.location.lng(),y={propertyName:m.name??"",address:m.formatted_address??"",city:(j=(T=m.address_components)==null?void 0:T.find(U=>U.types.includes("locality")))==null?void 0:j.long_name,state:(F=(N=m.address_components)==null?void 0:N.find(U=>U.types.includes("administrative_area_level_1")))==null?void 0:F.short_name,googleMapsUrl:m.url??`https://www.google.com/maps/search/?api=1&query=${g},${f}`,lat:g,lng:f};d(y),r({lat:g,lng:f}),o(y)};return h?e.jsx(D,{control:t,name:a,render:({field:o})=>e.jsxs(S,{children:[e.jsx(C,{htmlFor:a,children:"Event Location"}),e.jsx(L,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(St,{onLoad:m=>i.current=m,onPlaceChanged:()=>u(o.onChange),children:e.jsx(M,{id:"location",placeholder:"Search for a location...",className:"w-full"})}),e.jsx("div",{className:"w-full h-72 rounded-md border",children:e.jsxs(kt,{center:n,zoom:15,mapContainerClassName:"w-full h-full rounded-2xl",options:Et,children:[s&&e.jsx(Pt,{position:{lat:n.lat??I.lat,lng:n.lng??I.lng},onClick:()=>c(!0)}),s&&l&&e.jsx(Ft,{position:{lat:n.lat??I.lat,lng:n.lng??I.lng},onCloseClick:()=>c(!1),children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h3",{className:"font-semibold text-md text-primary",children:s.propertyName}),e.jsx("p",{className:"text-sm text-gray-500",children:s.address}),s.city&&s.state&&e.jsxs("p",{className:"text-sm text-gray-400",children:[s.city,", ",s.state]}),e.jsx("a",{href:s.googleMapsUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary underline text-sm",children:"View on Google Maps"})]})})]})})]})}),e.jsx(P,{})]})}):e.jsx("p",{children:"Loading map..."})};function oe({className:t,...a}){return e.jsx(ke,{"data-slot":"checkbox",className:v("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:e.jsx(Pe,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(xe,{className:"size-3.5"})})})}const Vt=({control:t,name:a})=>{const{field:{value:s,onChange:d}}=Z({name:a,control:t}),[l,c]=x.useState(s===0),n=i=>{const h=i.target.value?Number(i.target.value):0;d(h),h>0&&c(!1)},r=()=>{const i=!l;c(i),d(i?0:"")};return e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{control:t,name:a,render:()=>e.jsxs(S,{className:"text-start",children:[e.jsx(C,{htmlFor:"price",children:"Price"}),l?e.jsx("p",{className:"text-normal text-sm my-2",children:"Free"}):e.jsx(L,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"pe-1",children:"$"}),e.jsx(M,{placeholder:"0",id:"price",type:"number",value:s||"",onChange:n})]})}),e.jsx(P,{})]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(oe,{id:"freeEvent",checked:l,onCheckedChange:r}),e.jsx("label",{htmlFor:"freeEvent",className:"px-1 text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"This is a free event"})]})]})},At=({control:t,name:a})=>{const{field:{value:s,onChange:d}}=Z({name:a,control:t}),l=(c,n)=>{const r=c?[...s||[],n]:(s||[]).filter(i=>i!==n);d(r)};return e.jsxs(S,{className:"space-y-2",children:[e.jsx(C,{children:"Event Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2 max-sm:flex-col",children:zt.map(c=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(oe,{id:c,checked:s==null?void 0:s.includes(c),onCheckedChange:n=>l(!!n,c)}),e.jsx(C,{htmlFor:c,className:"text-sm font-normal",children:c})]},c))}),e.jsx(P,{})]})},$t=()=>{const{control:t,watch:a,setValue:s,trigger:d}=X(),l=a("music",["bachata","salsa"]),c=a("musicPercentages",{}),[n,r]=x.useState({}),[i,h]=x.useState(!1),u=x.useCallback(()=>{const o=Object.entries(c).filter(([g])=>g!=="others").reduce((g,[,f])=>g+((f==null?void 0:f.percentage)??0),0),m=Math.max(100-o,0);m>0?(s("musicPercentages.others",{name:"Others",percentage:m}),l.includes("others")||s("music",[...l,"others"])):(s("musicPercentages.others",{name:"Others",percentage:0}),l.includes("others")&&s("music",l.filter(g=>g!=="others"))),d("musicPercentages")},[c,l,s,d]);return x.useEffect(()=>{i||(l.forEach(o=>{var m;c[o]||s(`musicPercentages.${o}`,{name:((m=R.find(g=>g.id===o))==null?void 0:m.label)??o,percentage:o==="bachata"||o==="salsa"?50:0}),r(g=>({...g,[o]:`${o==="bachata"||o==="salsa"?50:0}`}))}),h(!0))},[l,c,s,i]),x.useEffect(()=>{Object.keys(c).filter(m=>m!=="others"&&!l.includes(m)).forEach(m=>{var g;s(`musicPercentages.${m}`,{name:((g=R.find(f=>f.id===m))==null?void 0:g.label)??m,percentage:0}),r(f=>({...f,[m]:"0"}))})},[l,c,s]),x.useEffect(()=>{u()},[c,u]),e.jsxs(S,{className:"space-y-2",children:[e.jsx(C,{children:"Music Breakdown"}),l.length===0?e.jsx("p",{className:"text-start text-sm text-gray-500",children:"No music categories selected"}):l.map(o=>{const m=R.find(g=>g.id===o);return m&&e.jsx(q,{control:t,name:`musicPercentages.${o}.percentage`,render:({field:g})=>e.jsxs(S,{className:"flex items-center justify-between gap-2",children:[e.jsx(C,{className:"w-1/3 text-sm font-medium",children:m.label}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{children:e.jsx(M,{type:"number",value:n[o]??g.value??"",onChange:f=>{r(y=>({...y,[o]:f.target.value}))},onBlur:()=>{const f=n[o]?Number(n[o]):void 0;s(`musicPercentages.${o}.percentage`,f),u(),r(y=>{const w={...y};return delete w[o],w})},className:"flex grow"})}),e.jsx("span",{children:"%"})]})]})},o)}),l.includes("others")&&c.others&&e.jsx(q,{control:t,name:"musicPercentages.others.percentage",render:({field:o})=>e.jsxs(S,{className:"flex items-center justify-between gap-2",children:[e.jsx(C,{className:"w-1/3 text-sm font-medium",children:"Others"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{children:e.jsx(M,{type:"number",value:n.others??o.value??"",onChange:m=>{r(g=>({...g,others:m.target.value}))},onBlur:()=>{const m=n.others?Number(n.others):void 0;s("musicPercentages.others.percentage",m),u(),r(g=>{const f={...g};return delete f.others,f})},className:"flex grow"})}),e.jsx("span",{children:"%"})]})]})},"others"),e.jsx(P,{})]})};function Ht({className:t,classNames:a,showOutsideDays:s=!0,...d}){return e.jsx(Fe,{showOutsideDays:s,className:v("p-3",t),classNames:{months:"flex flex-col sm:flex-row gap-2",month:"flex flex-col gap-4",caption:"flex justify-center pt-1 relative items-center w-full",caption_label:"text-sm font-medium",nav:"flex items-center gap-1",nav_button:v(le({variant:"outline"}),"size-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-x-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:v("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-range-end)]:rounded-r-md",d.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:v(le({variant:"ghost"}),"size-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start aria-selected:bg-primary aria-selected:text-primary-foreground",day_range_end:"day-range-end aria-selected:bg-primary aria-selected:text-primary-foreground",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:({className:l,...c})=>e.jsx(ze,{className:v("size-4",l),...c}),IconRight:({className:l,...c})=>e.jsx(Ee,{className:v("size-4",l),...c})},...d})}function Bt({...t}){return e.jsx(Le,{"data-slot":"popover",...t})}function qt({...t}){return e.jsx(Te,{"data-slot":"popover-trigger",...t})}function Wt({className:t,align:a="center",sideOffset:s=4,...d}){return e.jsx(De,{children:e.jsx(_e,{"data-slot":"popover-content",align:a,sideOffset:s,className:v("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...d})})}function B({className:t,children:a,...s}){return e.jsxs(Me,{"data-slot":"scroll-area",className:v("relative",t),...s,children:[e.jsx(Ue,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:a}),e.jsx(Y,{}),e.jsx(Ie,{})]})}function Y({className:t,orientation:a="vertical",...s}){return e.jsx(Re,{"data-slot":"scroll-area-scrollbar",orientation:a,className:v("flex touch-none p-px transition-colors select-none",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",t),...s,children:e.jsx(Oe,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function Kt({...t}){return e.jsx(Ve,{"data-slot":"select",...t})}function Gt({...t}){return e.jsx(He,{"data-slot":"select-value",...t})}function Jt({className:t,size:a="default",children:s,...d}){return e.jsxs(Ae,{"data-slot":"select-trigger","data-size":a,className:v("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...d,children:[s,e.jsx($e,{asChild:!0,children:e.jsx(he,{className:"size-4 opacity-50"})})]})}function Qt({className:t,children:a,position:s="popper",...d}){return e.jsx(Be,{children:e.jsxs(qe,{"data-slot":"select-content",className:v("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...d,children:[e.jsx(Yt,{}),e.jsx(We,{className:v("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),e.jsx(Xt,{})]})})}function V({className:t,children:a,...s}){return e.jsxs(Ke,{"data-slot":"select-item",className:v("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...s,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(Ge,{children:e.jsx(xe,{className:"size-4"})})}),e.jsx(Je,{children:a})]})}function Yt({className:t,...a}){return e.jsx(Qe,{"data-slot":"select-scroll-up-button",className:v("flex cursor-default items-center justify-center py-1",t),...a,children:e.jsx(Ye,{className:"size-4"})})}function Xt({className:t,...a}){return e.jsx(Xe,{"data-slot":"select-scroll-down-button",className:v("flex cursor-default items-center justify-center py-1",t),...a,children:e.jsx(he,{className:"size-4"})})}function ue({form:t,label:a,formFieldName:s}){function d(n){n&&t.setValue(s,n)}function l(n){const r=rt(new Date,parseInt(n)),i=t.getValues(s);i?r.setHours(i.getHours(),i.getMinutes(),i.getSeconds()):r.setHours(0,0,0,0),t.setValue(s,r)}function c(n,r){const i=t.getValues(s)||new Date,h=new Date(i);if(n==="hour"){const u=parseInt(r,10);h.getHours()>=12?h.setHours(u+12):h.setHours(u%12)}else if(n==="minute")h.setMinutes(parseInt(r,10));else if(n==="ampm"){const u=h.getHours();r==="AM"&&u>=12?h.setHours(u-12):r==="PM"&&u<12&&h.setHours(u+12)}t.setValue(s,h)}return e.jsx(D,{control:t.control,name:s,render:({field:n})=>e.jsxs(S,{className:"flex flex-col text-start",children:[e.jsx(C,{children:a}),e.jsxs(Bt,{children:[e.jsx(qt,{asChild:!0,children:e.jsx(L,{children:e.jsxs(b,{variant:"outline",className:v("w-full pl-3 text-left font-normal",!n.value&&"text-muted-foreground"),children:[n.value?at(n.value,"MM/dd/yyyy hh:mm aa"):e.jsx("span",{children:"Select date and time"}),e.jsx(Ze,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(Wt,{className:"w-auto p-2",children:e.jsxs("div",{className:"flex-col sm:flex",children:[e.jsx("div",{children:e.jsxs(Kt,{onValueChange:l,children:[e.jsx(Jt,{children:e.jsx(Gt,{placeholder:"Select"})}),e.jsxs(Qt,{position:"popper",children:[e.jsx(V,{value:"0",children:"Today"}),e.jsx(V,{value:"1",children:"Tomorrow"}),e.jsx(V,{value:"3",children:"In 3 days"}),e.jsx(V,{value:"7",children:"In a week"})]})]})}),e.jsxs("div",{className:"sm:flex",children:[e.jsx(Ht,{mode:"single",selected:n.value,onSelect:d,initialFocus:!0}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:h-[300px] divide-y sm:divide-y-0 sm:divide-x",children:[e.jsxs(B,{className:"w-64 sm:w-auto",children:[e.jsx("div",{className:"flex sm:flex-col p-2",children:Array.from({length:12},(r,i)=>i+1).reverse().map(r=>e.jsx(b,{size:"icon",variant:n.value&&n.value.getHours()%12===r%12?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>c("hour",r.toString()),children:r},r))}),e.jsx(Y,{orientation:"horizontal",className:"sm:hidden"})]}),e.jsxs(B,{className:"w-64 sm:w-auto",children:[e.jsx("div",{className:"flex sm:flex-col p-2",children:Array.from({length:12},(r,i)=>i*5).map(r=>e.jsx(b,{size:"icon",variant:n.value&&n.value.getMinutes()===r?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>c("minute",r.toString()),children:r.toString().padStart(2,"0")},r))}),e.jsx(Y,{orientation:"horizontal",className:"sm:hidden"})]}),e.jsx(B,{className:"",children:e.jsx("div",{className:"flex sm:flex-col p-2",children:["AM","PM"].map(r=>e.jsx(b,{size:"icon",variant:n.value&&(r==="AM"&&n.value.getHours()<12||r==="PM"&&n.value.getHours()>=12)?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>c("ampm",r),children:r},r))})})]})]})]})})]}),e.jsx(P,{})]})})}const Zt=({control:t,name:a})=>{const{getValues:s,setValue:d}=X(),{field:{value:l,onChange:c}}=Z({name:a,control:t}),n=(r,i)=>{const h=r?[...l||[],i]:(l==null?void 0:l.filter(u=>u!==i))||[];if(c(h),!r){const u=s("musicPercentages")||{},o=Object.fromEntries(Object.entries(u).filter(([m])=>m!==i));d("musicPercentages",o)}};return e.jsxs(S,{children:[e.jsx(C,{children:"Music"}),R.map(r=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{id:r.id,checked:l==null?void 0:l.includes(r.id),onCheckedChange:i=>n(!!i,r.id)}),e.jsx(C,{htmlFor:r.id,className:"text-sm font-normal",children:r.label})]},r.id)),e.jsx(P,{})]})},es=()=>{const[t,a]=x.useState(!0),[s,d]=x.useState(null),[l,c]=x.useState(null);return x.useEffect(()=>{if(A.get("auth_token")){const r=ct(_,async i=>{if(i){const h=z(k,"organizers",i.uid),u=await re(h);u.exists()?c(u.data()):d("No organizer data found")}else d("User not authenticated");a(!1)});return()=>r()}else a(!1),d("No authentication token found. Please log in")},[]),{loading:t,error:s,profileData:l}},ts=()=>{const[t,a]=x.useState(null),[s,d]=x.useState(null),[l,c]=x.useState(!0);return x.useEffect(()=>{(async()=>{const r=_.currentUser;if(!r){c(!1);return}try{const i=z(k,"organizers",r.uid),h=await re(i);if(h.exists()){const u=h.data();a((u==null?void 0:u.socialMediaLink)??null),d((u==null?void 0:u.websiteLink)??null)}}catch(i){console.warn("Could not fetch organizer social link:",i)}finally{c(!1)}})()},[]),{socialLink:t,websiteLink:s,loading:l}},ss=()=>{const[t,a]=x.useState(!1),[s,d]=x.useState(null),[l,c]=x.useState(!1);return{loading:t,error:s,success:l,updateProfile:async r=>{var h;if(a(!0),d(null),c(!1),A.get("auth_token"))try{await((h=_.currentUser)==null?void 0:h.getIdToken(!0));const u=_.currentUser;if(u){const o=z(k,"organizers",u.uid);await dt(o,r),c(!0)}else d("User not authenticated")}catch(u){console.error("Error updating profile:",u),d("Failed to update profile. Please try again.")}finally{a(!1)}else a(!1),d("No authentication token found. Please log in again.")}}},as=({className:t,...a})=>{const[s,d]=x.useState(!1),[l,c]=x.useState(!1),n=et({resolver:tt(Mt),defaultValues:{music:["bachata","salsa"],location:{},musicPercentages:{...Object.fromEntries(R.map(o=>[o.id,{name:o.label,percentage:o.id==="bachata"||o.id==="salsa"?50:0}])),others:{name:"Others",percentage:0}}}}),{socialLink:r,websiteLink:i}=ts(),h=n.watch(),u=async o=>{var y,w,T;d(!0);let m="";const g=_.currentUser;if(!g){console.error("User not authenticated"),d(!1);return}try{if(o.image instanceof File){const j=ut(nt,`events/${Date.now()}-${o.image.name}`);await mt(j,o.image),m=await xt(j)}}catch(j){console.error("Image upload failed:",j),d(!1);return}const f={title:o.title,startTime:o.startTime,endTime:o.endTime,imageUrl:m,description:(y=o.description)==null?void 0:y.trim(),price:o.price,eventTags:o.eventTags,music:o.music,musicPercentages:o.musicPercentages,location:o.location,link:o.link,organizerId:g.uid,organizerSocialLink:r,websiteLink:i,createdAt:ht()};try{const j=z(fe(k,"events")),N=j.id,F=((w=f.location)==null?void 0:w.city)??"UnknownCity",U=((T=f.location)==null?void 0:T.state)??"UnknownState",ie=z(k,"states",U),be=await re(ie);await O(j,f),be.exists()||await O(ie,{});const ye=z(k,"states",U,"cities",F,"events",N);await O(ye,f),await O(z(k,"organizers",g.uid,"events",N),f),E.success("Event created!",{description:new Date().toLocaleString(),action:{label:"Close",onClick:()=>{}}}),console.log("Event successfully created in both collections!")}catch(j){E.error("There was an error saving your event. Please try again",{description:j instanceof Error?j.message:"Firestore error",action:{label:"Close",onClick:()=>{}}}),console.error("Firestore error:",j)}d(!1)};return x.useEffect(()=>{if(h.image instanceof File){const o=URL.createObjectURL(h.image);return()=>URL.revokeObjectURL(o)}},[h.image]),e.jsx("div",{className:v("w-full flex flex-col gap-6 m-2",t),...a,children:e.jsxs(ee,{children:[e.jsx(te,{children:e.jsx(se,{className:"text-2xl",children:"Create Event"})}),e.jsxs(ae,{children:[e.jsx(Dt,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(u),className:"flex flex-col justify-center py-2 gap-4",children:[e.jsx(D,{control:n.control,name:"title",render:({field:o})=>e.jsxs(S,{className:"text-start",children:[e.jsx(C,{htmlFor:"title",children:"Title"}),e.jsx(L,{children:e.jsx(M,{id:"title",placeholder:"Dance Social",...o})}),e.jsx(P,{})]})}),e.jsx(Ot,{control:n.control,name:"location"}),e.jsx(ue,{form:n,label:"Start time",formFieldName:"startTime"}),e.jsx(ue,{form:n,label:"End time",formFieldName:"endTime"}),e.jsx(Ut,{control:n.control,name:"image"}),e.jsx(D,{control:n.control,name:"description",render:({field:o})=>e.jsxs(S,{children:[e.jsx(C,{children:"Description"}),e.jsx(L,{children:e.jsx(_t,{...o})}),e.jsx(P,{})]})}),e.jsx(Vt,{control:n.control,name:"price"}),e.jsx(At,{control:n.control,name:"eventTags"}),e.jsx(Zt,{control:n.control,name:"music"}),e.jsx($t,{}),e.jsx(D,{control:n.control,name:"link",render:({field:o})=>e.jsxs(S,{children:[e.jsx(C,{children:"Link"}),e.jsx(L,{children:e.jsx(M,{placeholder:"event link (optional)","aria-label":"link for additional details",...o})}),e.jsx(P,{})]})})]})}),e.jsxs("div",{className:"flex gap-4 justify-between",children:[e.jsxs(W,{children:[e.jsx(K,{asChild:!0,children:e.jsx(b,{type:"button",variant:"outline",disabled:!n.formState.isValid,children:"Preview Event"})}),e.jsxs(G,{children:[e.jsx(J,{children:e.jsx(Q,{children:"Preview Event"})}),e.jsx("div",{className:"text-center overflow-y-auto max-h-[75vh]",children:e.jsx(pe,{social:{id:"preview",...h,imageUrl:h.image instanceof File?URL.createObjectURL(h.image):"",createdAt:new Date,organizerSocialLink:r??""}})})]})]}),e.jsxs(W,{open:l,onOpenChange:c,children:[e.jsx(K,{asChild:!0,children:e.jsx(b,{type:"button",disabled:s||!n.formState.isValid,onClick:()=>c(!0),children:s?"Submitting...":"Post Event"})}),e.jsxs(G,{children:[e.jsx(J,{children:e.jsx(Q,{children:"Confirm Event Submission"})}),e.jsx("p",{children:"Are you sure you want to post this event? Please double-check your details 💃"}),e.jsxs(ge,{children:[e.jsx(bt,{asChild:!0,children:e.jsx(b,{variant:"outline",children:"Cancel"})}),e.jsx(b,{onClick:n.handleSubmit(o=>{c(!1),u(o)}),disabled:s||!n.formState.isValid,children:"Yes, Post It"})]})]})]})]})]})]})})},rs=()=>{const[t]=ft(_),[a,s]=x.useState([]),[d,l]=x.useState(!0);if(x.useEffect(()=>{if(!t)return;(async()=>{try{const r=fe(k,`organizers/${t.uid}/events`),i=gt(r,pt("createdAt","desc")),u=(await jt(i)).docs.map(o=>{const m=o.data();return{id:o.id,...m,createdAt:m.createdAt.toDate(),startTime:m.startTime.toDate(),endTime:m.endTime.toDate()}});s(u)}catch(r){console.error("Error fetching previous posts:",r)}finally{l(!1)}})()},[t]),!t)return e.jsx("p",{children:"Please log in to view your previous posts."});if(d)return e.jsx("p",{children:"Loading previous posts..."});const c=async n=>{if(t)try{const r=z(k,"events",n);await ce(r);const i=z(k,`organizers/${t.uid}/events`,n);await ce(i),E.success("Event deleted successfully!"),s(h=>h.filter(u=>u.id!==n))}catch(r){console.error("Error deleting event:",r)}};return a.length===0?e.jsx("p",{children:"No previously events posted"}):e.jsx("div",{className:"flex flex-col",children:a.map(n=>e.jsxs("div",{className:"border rounded-md p-2 m-2 relative",children:[e.jsx(pe,{social:n}),e.jsxs(W,{children:[e.jsx(K,{asChild:!0,children:e.jsx(b,{variant:"destructive",children:"Delete"})}),e.jsxs(G,{children:[e.jsxs(J,{children:[e.jsx(Q,{children:"Are you sure you want to delete this event?"}),e.jsx(yt,{children:"This will permanently delete the event from both your organizer account and the global events list"})]}),e.jsxs(ge,{children:[e.jsx(b,{variant:"outline",children:"Cancel"}),e.jsx(b,{variant:"destructive",onClick:()=>c(n.id),children:"Confirm Delete"})]})]})]})]},n.id))})},ns=()=>{const[t,a]=x.useState(!0),[s,d]=x.useState([]),[l,c]=x.useState([]),{loading:n,error:r,profileData:i}=es(),{loading:h,error:u,success:o,updateProfile:m}=ss();x.useEffect(()=>{if(i&&l.length===0){const y=[{label:"Email",value:i.email},{label:"First name",value:i.firstName||""},{label:"Last name",value:i.lastName||""},{label:"Social Media",value:i.socialMediaLink??""},{label:"Website",value:i.websiteLink??""}].map(w=>({...w}));c(y),d(y)}},[i,l.length]),x.useEffect(()=>()=>{E.dismiss()},[]);const g=async()=>{if(!i){E.error("Profile data not found");return}const f={"First name":"firstName","Last name":"lastName","Social Media":"socialMediaLink",Website:"websiteLink"},y=s.reduce((j,N)=>{const F=f[N.label];return F&&(j[F]=N.value),j},{}),{...w}=y;if(!s.some(j=>{const N=l.find(F=>F.label===j.label);return(N==null?void 0:N.value)!==j.value})){E("No changes detected. Profile not updated");return}await m(w),c(s.map(j=>({...j}))),a(!0)};if(x.useEffect(()=>{o&&E.success("Successfully updated your profile"),u&&E.error("An error occurred while updating profile, please try again")},[o,u]),n)return e.jsx("div",{children:e.jsx("p",{children:"Profile loading..."})});if(r){E.error(r);return}return e.jsxs("div",{className:"flex flex-col items-center mt-4",children:[e.jsx(st,{richColors:!0,position:"top-center",className:"text-start"}),e.jsx("div",{children:e.jsxs(ee,{className:"md:w-[450px]",children:[e.jsx(te,{children:e.jsx(se,{children:"Profile"})}),e.jsx(ae,{children:e.jsx("ul",{className:"flex-col mt-4",children:s.map((f,y)=>e.jsxs("li",{className:"flex gap-1 items-center text-start mb-2 justify-between",children:[e.jsx("label",{className:"w-1/4",children:f.label}),e.jsx(M,{value:f.value,onChange:w=>{const T=s.map((j,N)=>N===y?{...j,value:w.target.value}:j);d(T)},disabled:f.label==="Email"||t,className:"w-3/4"})]},f.label))})}),e.jsxs(ot,{className:"flex justify-between",children:[e.jsx(b,{variant:"link",onClick:()=>{a(!t)},disabled:!t,children:"Edit Profile"}),e.jsx(b,{onClick:g,disabled:h||t,variant:t?"outline":"default",children:"Update Profile"})]})]})})]})},os=({className:t,...a})=>e.jsx("div",{className:v("flex flex-col gap-6 m-2",t),...a,children:e.jsxs(ee,{className:"min-h-svh",children:[e.jsx(te,{children:e.jsx(se,{className:"text-2xl",children:"Organizer Dashboard"})}),e.jsx(ae,{children:e.jsx("div",{className:"flex min-h-full w-full justify-center px-0 sm:px-8",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs(wt,{defaultValue:"create-post",className:"w-full",children:[e.jsxs(Nt,{className:"grid w-full grid-cols-3",children:[e.jsx($,{value:"create-post",children:"Create Post"}),e.jsx($,{value:"post",children:"Posts"}),e.jsx($,{value:"profile",children:"Profile"})]}),e.jsx(H,{value:"create-post",className:"flex",children:e.jsx(as,{})}),e.jsx(H,{value:"post",children:e.jsx(rs,{})}),e.jsx(H,{value:"profile",children:e.jsx(ns,{})})]})})})})]})});function gs(){const t=me();return x.useEffect(()=>{const a=A.get("auth_token");a?a===void 0&&t("/"):t("/login")},[t]),e.jsxs("div",{children:[e.jsx(it,{}),e.jsx(os,{}),e.jsx(Tt,{})]})}export{gs as default};
