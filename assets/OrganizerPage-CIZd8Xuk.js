import{u as se,j as e,F as de,r as g,C as $,S as ue,h as R,i as me,I as xe,k as fe,l as ge,m as ae,n as re,D as he,o as pe,p as je,q as ve,s as be,t as ye,v as we,w as Ne,V as Ce,x as Se,y as Pe,z as ke,A as Fe,E as ze,G as _e,H as ne,J as Me,K as Te,M as Ie,N as De,O as Ee,Q as Le,U as Ue,W as Oe,X as Ve,Y as $e,Z as Ae,_ as Re,$ as He,a0 as z,a1 as Be}from"./react-CxQfEXQ1.js";import{aX as E,aY as p,aG as qe,aA as Ke}from"./vendor-C9WekQ6T.js";import{h as T,B as y,c as j,I as F,i as Y,C as H,a as B,b as q,d as K,s as We,g as D,f as Ge,H as Je}from"./card-dMxWVPrQ.js";import{s as Xe,r as Ye,u as Qe,a as Ze,b as Q,c as Z,d as et,o as tt,e as oe,f as st,h as at,T as rt}from"./firebase-JXYPez0V.js";import{L as nt,T as ot,a as lt,b as U,c as O}from"./label-C00YRULL.js";import{u as it,A as ct,G as dt,M as ut,I as mt}from"./google-maps-C1MYJ28T.js";import{m as xt,a as M}from"./event-Cf9_RtTC.js";import"./shadcn-ui-BA32w1ww.js";import"./index-dlH8MWOD.js";const ft=()=>{const t=se();return{handleSignOut:async()=>{try{const s=await Xe(T);console.log(s),E.remove("auth_token"),t("/login")}catch(s){console.error("Error during sign out: ",s)}}}},gt=()=>{const{handleSignOut:t}=ft();return e.jsx(y,{onClick:t,children:"Log out"})},ht=de,le=g.createContext({}),k=({...t})=>e.jsx(le.Provider,{value:{name:t.name},children:e.jsx($,{...t})}),W=()=>{const t=g.useContext(le),a=g.useContext(ie),{getFieldState:s}=R(),l=me({name:t.name}),o=s(t.name,l);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:u}=a;return{id:u,name:t.name,formItemId:`${u}-form-item`,formDescriptionId:`${u}-form-item-description`,formMessageId:`${u}-form-item-message`,...o}},ie=g.createContext({});function w({className:t,...a}){const s=g.useId();return e.jsx(ie.Provider,{value:{id:s},children:e.jsx("div",{"data-slot":"form-item",className:j("grid gap-2",t),...a})})}function b({className:t,...a}){const{error:s,formItemId:l}=W();return e.jsx(nt,{"data-slot":"form-label","data-error":!!s,className:j("data-[error=true]:text-destructive",t),htmlFor:l,...a})}function C({...t}){const{error:a,formItemId:s,formDescriptionId:l,formMessageId:o}=W();return e.jsx(ue,{"data-slot":"form-control",id:s,"aria-describedby":a?`${l} ${o}`:`${l}`,"aria-invalid":!!a,...t})}function S({className:t,...a}){const{error:s,formMessageId:l}=W(),o=s?String((s==null?void 0:s.message)??""):a.children;return o?e.jsx("p",{"data-slot":"form-message",id:l,className:j("text-destructive text-sm",t),...a,children:o}):null}function pt({className:t,...a}){return e.jsx("textarea",{"data-slot":"textarea",className:j("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}const ee=p.object({name:p.string(),percentage:p.number().max(100,"Percentage cannot exceed 100%")}),jt=p.object({title:p.string().min(3,"Title is required"),startTime:p.date({required_error:"A start date and time is required"}),endTime:p.date({required_error:"An end date and time is required"}),price:p.number(),description:p.string().optional(),image:p.instanceof(File).optional(),link:p.string().optional(),music:p.array(p.string()).nonempty("Select at least one category"),musicPercentages:p.record(p.string(),ee).and(p.object({others:ee}).optional()).refine(t=>Object.values(t).reduce((a,s)=>a+s.percentage,0)<=100,{message:"Total music percentages cannot exceed 100%"}),location:p.object({propertyName:p.string().optional(),address:p.string().optional(),city:p.string().optional(),state:p.string().optional(),googleMapsUrl:p.string().optional(),lat:p.number().optional(),lng:p.number().optional()}).optional()}),vt=({control:t,name:a})=>e.jsx(k,{control:t,name:a,render:({field:s})=>e.jsxs(w,{children:[e.jsx(b,{htmlFor:"imageUpload",children:"Upload Image"}),e.jsx(C,{children:e.jsx(bt,{id:"imageUpload",value:s.value||void 0,onChange:s.onChange})}),e.jsx(S,{})]})}),bt=({id:t,value:a,onChange:s})=>{const[l,o]=g.useState(null),u=g.useRef(null);g.useEffect(()=>{if(a instanceof File){const n=URL.createObjectURL(a);return o(n),()=>URL.revokeObjectURL(n)}else o(null)},[a]);const r=n=>{var f;const i=(f=n[0])==null?void 0:f.file;i instanceof File?s(i):(console.warn("Selected image is not a valid File object"),s(void 0))};return e.jsx(xe,{multiple:!1,value:a?[{file:a,data_url:l??""}]:[],onChange:r,dataURLKey:"data_url",children:({onImageUpload:n,onImageUpdate:i,onImageRemove:f,isDragging:m,dragProps:c})=>e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("input",{id:t,type:"file",ref:u,className:"hidden",onChange:d=>{var h;const x=(h=d.target.files)==null?void 0:h[0];x instanceof File&&s(x)}}),e.jsx(y,{type:"button",style:m?{backgroundColor:"limegreen",transition:"0.25s"}:void 0,onClick:n,...c,children:"Click or Drop image here"}),l&&e.jsxs("div",{children:[e.jsx("img",{src:l,alt:"event preview",className:"rounded-2xl"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(y,{type:"button",onClick:()=>i(0),children:"Update"}),e.jsx(y,{type:"button",onClick:()=>f(0),children:"Remove"})]})]})]})})},yt=["places","marker"],_={lat:43.0722,lng:-89.4008},wt=({control:t,name:a})=>{const[s,l]=g.useState(null),[o,u]=g.useState(!1),[r,n]=g.useState(_),i=g.useRef(null),{isLoaded:f}=it({googleMapsApiKey:"AIzaSyBuImOK6KWeeg3f71cgw6R-ssJj4arkAjk",libraries:yt}),m=c=>{var N,P,G,J,X;if(!i.current)return;const d=i.current.getPlace();if(!((N=d.geometry)!=null&&N.location))return;const x=d.geometry.location.lat(),h=d.geometry.location.lng(),v={propertyName:d.name??"",address:d.formatted_address??"",city:(G=(P=d.address_components)==null?void 0:P.find(L=>L.types.includes("locality")))==null?void 0:G.long_name,state:(X=(J=d.address_components)==null?void 0:J.find(L=>L.types.includes("administrative_area_level_1")))==null?void 0:X.short_name,googleMapsUrl:d.url?d.url:`https://www.google.com/maps/search/?api=1&query=${x},${h}`,lat:x,lng:h};l(v),n({lat:x,lng:h}),c(v)};return f?e.jsx(k,{control:t,name:a,render:({field:c})=>e.jsxs(w,{children:[e.jsx(b,{htmlFor:a,children:"Event Location"}),e.jsx(C,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(ct,{onLoad:d=>i.current=d,onPlaceChanged:()=>m(c.onChange),children:e.jsx(F,{id:"location",placeholder:"Search for a location...",className:"w-full"})}),e.jsx("div",{className:"w-full h-72 rounded-md border",children:e.jsxs(dt,{center:r,zoom:15,mapContainerClassName:"w-full h-full rounded-2xl",options:xt,children:[s&&e.jsx(ut,{position:{lat:r.lat??_.lat,lng:r.lng??_.lng},onClick:()=>u(!0)}),s&&o&&e.jsx(mt,{position:{lat:r.lat??_.lat,lng:r.lng??_.lng},onCloseClick:()=>u(!1),children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h3",{className:"font-semibold text-md text-primary",children:s.propertyName}),e.jsx("p",{className:"text-sm text-gray-500",children:s.address}),s.city&&s.state&&e.jsxs("p",{className:"text-sm text-gray-400",children:[s.city,", ",s.state]}),e.jsx("a",{href:s.googleMapsUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary underline text-sm",children:"View on Google Maps"})]})})]})})]})}),e.jsx(S,{})]})}):e.jsx("p",{children:"Loading map..."})};function ce({className:t,...a}){return e.jsx(fe,{"data-slot":"checkbox",className:j("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:e.jsx(ge,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(ae,{className:"size-3.5"})})})}const Nt=({control:t,name:a})=>{const{field:{value:s,onChange:l}}=re({name:a,control:t}),[o,u]=g.useState(s===0),r=i=>{const f=i.target.value?Number(i.target.value):0;l(f),f>0&&u(!1)},n=()=>{const i=!o;u(i),l(i?0:"")};return e.jsxs("div",{className:"space-y-2",children:[!o&&e.jsx(k,{control:t,name:a,render:()=>e.jsxs(w,{className:"text-start",children:[e.jsx(b,{htmlFor:"price",children:"Price"}),e.jsx(C,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"pe-1",children:"$"}),e.jsx(F,{placeholder:"0",id:"price",type:"number",value:s||"",onChange:r})]})}),e.jsx(S,{})]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{id:"freeEvent",checked:o,onCheckedChange:n}),e.jsx("label",{htmlFor:"freeEvent",className:"px-1 text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"This is a free event"})]})]})},Ct=()=>{const{control:t,watch:a,setValue:s,trigger:l}=R(),o=a("music",["bachata","salsa"]),u=a("musicPercentages",{}),[r,n]=g.useState({}),[i,f]=g.useState(!1),m=g.useCallback(()=>{const c=Object.entries(u).filter(([x])=>x!=="others").reduce((x,[,h])=>x+((h==null?void 0:h.percentage)??0),0),d=Math.max(100-c,0);d>0?(s("musicPercentages.others",{name:"Others",percentage:d}),o.includes("others")||s("music",[...o,"others"])):(s("musicPercentages.others",{name:"Others",percentage:0}),o.includes("others")&&s("music",o.filter(x=>x!=="others"))),l("musicPercentages")},[u,o,s,l]);return g.useEffect(()=>{i||(o.forEach(c=>{var d;u[c]||s(`musicPercentages.${c}`,{name:((d=M.find(x=>x.id===c))==null?void 0:d.label)??c,percentage:c==="bachata"||c==="salsa"?50:0}),n(x=>({...x,[c]:`${c==="bachata"||c==="salsa"?50:0}`}))}),f(!0))},[o,u,s,i]),g.useEffect(()=>{Object.keys(u).filter(d=>d!=="others"&&!o.includes(d)).forEach(d=>{var x;s(`musicPercentages.${d}`,{name:((x=M.find(h=>h.id===d))==null?void 0:x.label)??d,percentage:0}),n(h=>({...h,[d]:"0"}))})},[o,u,s]),g.useEffect(()=>{m()},[u,m]),e.jsxs(w,{className:"space-y-2",children:[e.jsx(b,{children:"Music Breakdown"}),o.length===0?e.jsx("p",{className:"text-start text-sm text-gray-500",children:"No music categories selected"}):o.map(c=>{const d=M.find(x=>x.id===c);return d&&e.jsx($,{control:t,name:`musicPercentages.${c}.percentage`,render:({field:x})=>e.jsxs(w,{className:"flex items-center justify-between gap-2",children:[e.jsx(b,{className:"w-1/3 text-sm font-medium",children:d.label}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(C,{children:e.jsx(F,{type:"number",value:r[c]??x.value??"",onChange:h=>{n(v=>({...v,[c]:h.target.value}))},onBlur:()=>{const h=r[c]?Number(r[c]):void 0;s(`musicPercentages.${c}.percentage`,h),m(),n(v=>{const N={...v};return delete N[c],N})},className:"flex grow"})}),e.jsx("span",{children:"%"})]})]})},c)}),o.includes("others")&&u.others&&e.jsx($,{control:t,name:"musicPercentages.others.percentage",render:({field:c})=>e.jsxs(w,{className:"flex items-center justify-between gap-2",children:[e.jsx(b,{className:"w-1/3 text-sm font-medium",children:"Others"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(C,{children:e.jsx(F,{type:"number",value:r.others??c.value??"",onChange:d=>{n(x=>({...x,others:d.target.value}))},onBlur:()=>{const d=r.others?Number(r.others):void 0;s("musicPercentages.others.percentage",d),m(),n(x=>{const h={...x};return delete h.others,h})},className:"flex grow"})}),e.jsx("span",{children:"%"})]})]})},"others"),e.jsx(S,{})]})};function St({className:t,classNames:a,showOutsideDays:s=!0,...l}){return e.jsx(he,{showOutsideDays:s,className:j("p-3",t),classNames:{months:"flex flex-col sm:flex-row gap-2",month:"flex flex-col gap-4",caption:"flex justify-center pt-1 relative items-center w-full",caption_label:"text-sm font-medium",nav:"flex items-center gap-1",nav_button:j(Y({variant:"outline"}),"size-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-x-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:j("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-range-end)]:rounded-r-md",l.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:j(Y({variant:"ghost"}),"size-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start aria-selected:bg-primary aria-selected:text-primary-foreground",day_range_end:"day-range-end aria-selected:bg-primary aria-selected:text-primary-foreground",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:({className:o,...u})=>e.jsx(je,{className:j("size-4",o),...u}),IconRight:({className:o,...u})=>e.jsx(pe,{className:j("size-4",o),...u})},...l})}function Pt({...t}){return e.jsx(ve,{"data-slot":"popover",...t})}function kt({...t}){return e.jsx(be,{"data-slot":"popover-trigger",...t})}function Ft({className:t,align:a="center",sideOffset:s=4,...l}){return e.jsx(ye,{children:e.jsx(we,{"data-slot":"popover-content",align:a,sideOffset:s,className:j("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...l})})}function V({className:t,children:a,...s}){return e.jsxs(Ne,{"data-slot":"scroll-area",className:j("relative",t),...s,children:[e.jsx(Ce,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:a}),e.jsx(A,{}),e.jsx(Se,{})]})}function A({className:t,orientation:a="vertical",...s}){return e.jsx(Pe,{"data-slot":"scroll-area-scrollbar",orientation:a,className:j("flex touch-none p-px transition-colors select-none",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",t),...s,children:e.jsx(ke,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function zt({...t}){return e.jsx(Fe,{"data-slot":"select",...t})}function _t({...t}){return e.jsx(Me,{"data-slot":"select-value",...t})}function Mt({className:t,size:a="default",children:s,...l}){return e.jsxs(ze,{"data-slot":"select-trigger","data-size":a,className:j("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...l,children:[s,e.jsx(_e,{asChild:!0,children:e.jsx(ne,{className:"size-4 opacity-50"})})]})}function Tt({className:t,children:a,position:s="popper",...l}){return e.jsx(Te,{children:e.jsxs(Ie,{"data-slot":"select-content",className:j("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...l,children:[e.jsx(It,{}),e.jsx(De,{className:j("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),e.jsx(Dt,{})]})})}function I({className:t,children:a,...s}){return e.jsxs(Ee,{"data-slot":"select-item",className:j("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...s,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(Le,{children:e.jsx(ae,{className:"size-4"})})}),e.jsx(Ue,{children:a})]})}function It({className:t,...a}){return e.jsx(Oe,{"data-slot":"select-scroll-up-button",className:j("flex cursor-default items-center justify-center py-1",t),...a,children:e.jsx(Ve,{className:"size-4"})})}function Dt({className:t,...a}){return e.jsx($e,{"data-slot":"select-scroll-down-button",className:j("flex cursor-default items-center justify-center py-1",t),...a,children:e.jsx(ne,{className:"size-4"})})}function te({form:t,label:a,formFieldName:s}){function l(r){r&&t.setValue(s,r)}function o(r){const n=Ke(new Date,parseInt(r)),i=t.getValues(s);i?n.setHours(i.getHours(),i.getMinutes(),i.getSeconds()):n.setHours(0,0,0,0),t.setValue(s,n)}function u(r,n){const i=t.getValues(s)||new Date,f=new Date(i);if(r==="hour"){const m=parseInt(n,10);f.getHours()>=12?f.setHours(m+12):f.setHours(m%12)}else if(r==="minute")f.setMinutes(parseInt(n,10));else if(r==="ampm"){const m=f.getHours();n==="AM"&&m>=12?f.setHours(m-12):n==="PM"&&m<12&&f.setHours(m+12)}t.setValue(s,f)}return e.jsx(k,{control:t.control,name:s,render:({field:r})=>e.jsxs(w,{className:"flex flex-col text-start",children:[e.jsx(b,{children:a}),e.jsxs(Pt,{children:[e.jsx(kt,{asChild:!0,children:e.jsx(C,{children:e.jsxs(y,{variant:"outline",className:j("w-full pl-3 text-left font-normal",!r.value&&"text-muted-foreground"),children:[r.value?qe(r.value,"MM/dd/yyyy hh:mm aa"):e.jsx("span",{children:"Select date and time"}),e.jsx(Ae,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(Ft,{className:"w-auto p-2",children:e.jsxs("div",{className:"flex-col sm:flex",children:[e.jsx("div",{children:e.jsxs(zt,{onValueChange:o,children:[e.jsx(Mt,{children:e.jsx(_t,{placeholder:"Select"})}),e.jsxs(Tt,{position:"popper",children:[e.jsx(I,{value:"0",children:"Today"}),e.jsx(I,{value:"1",children:"Tomorrow"}),e.jsx(I,{value:"3",children:"In 3 days"}),e.jsx(I,{value:"7",children:"In a week"})]})]})}),e.jsxs("div",{className:"sm:flex",children:[e.jsx(St,{mode:"single",selected:r.value,onSelect:l,initialFocus:!0}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:h-[300px] divide-y sm:divide-y-0 sm:divide-x",children:[e.jsxs(V,{className:"w-64 sm:w-auto",children:[e.jsx("div",{className:"flex sm:flex-col p-2",children:Array.from({length:12},(n,i)=>i+1).reverse().map(n=>e.jsx(y,{size:"icon",variant:r.value&&r.value.getHours()%12===n%12?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>u("hour",n.toString()),children:n},n))}),e.jsx(A,{orientation:"horizontal",className:"sm:hidden"})]}),e.jsxs(V,{className:"w-64 sm:w-auto",children:[e.jsx("div",{className:"flex sm:flex-col p-2",children:Array.from({length:12},(n,i)=>i*5).map(n=>e.jsx(y,{size:"icon",variant:r.value&&r.value.getMinutes()===n?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>u("minute",n.toString()),children:n.toString().padStart(2,"0")},n))}),e.jsx(A,{orientation:"horizontal",className:"sm:hidden"})]}),e.jsx(V,{className:"",children:e.jsx("div",{className:"flex sm:flex-col p-2",children:["AM","PM"].map(n=>e.jsx(y,{size:"icon",variant:r.value&&(n==="AM"&&r.value.getHours()<12||n==="PM"&&r.value.getHours()>=12)?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>u("ampm",n),children:n},n))})})]})]})]})})]}),e.jsx(S,{})]})})}const Et=({control:t,name:a})=>{const{getValues:s,setValue:l}=R(),{field:{value:o,onChange:u}}=re({name:a,control:t}),r=(n,i)=>{const f=n?[...o||[],i]:(o==null?void 0:o.filter(m=>m!==i))||[];if(u(f),!n){const m=s("musicPercentages")||{},c=Object.fromEntries(Object.entries(m).filter(([d])=>d!==i));l("musicPercentages",c)}};return e.jsxs(w,{children:[e.jsx(b,{children:"Music"}),M.map(n=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{id:n.id,checked:o==null?void 0:o.includes(n.id),onCheckedChange:i=>r(!!i,n.id)}),e.jsx(b,{htmlFor:n.id,className:"text-sm font-normal",children:n.label})]},n.id)),e.jsx(S,{})]})},Lt=({className:t,...a})=>{const[s,l]=g.useState(!1),o=Re({resolver:He(jt),defaultValues:{music:["bachata","salsa"],location:{},musicPercentages:{...Object.fromEntries(M.map(r=>[r.id,{name:r.label,percentage:r.id==="bachata"||r.id==="salsa"?50:0}])),others:{name:"Others",percentage:0}}}}),u=async r=>{var m;l(!0);let n="";const i=T.currentUser;if(!i){console.error("User not authenticated"),l(!1);return}try{if(r.image instanceof File){const c=Ye(We,`events/${Date.now()}-${r.image.name}`);await Qe(c,r.image),n=await Ze(c)}}catch(c){console.error("Image upload failed:",c),l(!1);return}const f={title:r.title,startTime:r.startTime,endTime:r.endTime,imageUrl:n,description:(m=r.description)==null?void 0:m.trim(),price:r.price,music:r.music,musicPercentages:r.musicPercentages,location:r.location,link:r.link,organizerId:i.uid,createdAt:et()};try{await Q(Z(D,"organizers",i.uid,"events"),f),await Q(Z(D,"events"),f),console.log("Event successfully created in both collections!")}catch(c){console.error("Firestore error:",c),alert("There was an error saving your event. Please try again.")}l(!1)};return e.jsx("div",{className:j("flex flex-col gap-6 m-2",t),...a,children:e.jsxs(H,{children:[e.jsx(B,{children:e.jsx(q,{className:"text-2xl",children:"Create Event"})}),e.jsx(K,{children:e.jsx(ht,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(u),className:"flex flex-col justify-center py-2 gap-4",children:[e.jsx(k,{control:o.control,name:"title",render:({field:r})=>e.jsxs(w,{className:"text-start",children:[e.jsx(b,{htmlFor:"title",children:"Title"}),e.jsx(C,{children:e.jsx(F,{id:"title",placeholder:"Dance Social",...r})}),e.jsx(S,{})]})}),e.jsx(wt,{control:o.control,name:"location"}),e.jsx(te,{form:o,label:"Start time",formFieldName:"startTime"}),e.jsx(te,{form:o,label:"End time",formFieldName:"endTime"}),e.jsx(vt,{control:o.control,name:"image"}),e.jsx(k,{control:o.control,name:"description",render:({field:r})=>e.jsxs(w,{children:[e.jsx(b,{children:"Description"}),e.jsx(C,{children:e.jsx(pt,{...r})}),e.jsx(S,{})]})}),e.jsx(Nt,{control:o.control,name:"price"}),e.jsx(Et,{control:o.control,name:"music"}),e.jsx(Ct,{}),e.jsx(k,{control:o.control,name:"link",render:({field:r})=>e.jsxs(w,{children:[e.jsx(b,{children:"Link"}),e.jsx(C,{children:e.jsx(F,{placeholder:"event link (optional)","aria-label":"link for additional details",...r})}),e.jsx(S,{})]})}),e.jsx(y,{type:"submit",disabled:s||!o.formState.isValid,children:s?"Submitting...":"Post Event"})]})})})]})})},Ut=()=>{const[t,a]=g.useState(!0),[s,l]=g.useState(null),[o,u]=g.useState(null);return g.useEffect(()=>{if(E.get("auth_token")){const n=tt(T,async i=>{if(i){const f=oe(D,"organizers",i.uid),m=await st(f);m.exists()?u(m.data()):l("No organizer data found")}else l("User not authenticated");a(!1)});return()=>n()}else a(!1),l("No authentication token found. Please log in")},[]),{loading:t,error:s,profileData:o}},Ot=()=>{const[t,a]=g.useState(!1),[s,l]=g.useState(null),[o,u]=g.useState(!1);return{loading:t,error:s,success:o,updateProfile:async n=>{var f;if(a(!0),l(null),u(!1),E.get("auth_token"))try{await((f=T.currentUser)==null?void 0:f.getIdToken(!0));const m=T.currentUser;if(m){const c=oe(D,"organizers",m.uid);await at(c,n),u(!0)}else l("User not authenticated")}catch(m){console.error("Error updating profile:",m),l("Failed to update profile. Please try again.")}finally{a(!1)}else a(!1),l("No authentication token found. Please log in again.")}}},Vt=()=>{const[t,a]=g.useState(!0),[s,l]=g.useState([]),{loading:o,error:u,profileData:r}=Ut(),{loading:n,error:i,success:f,updateProfile:m}=Ot();g.useEffect(()=>{r&&l([{label:"Email",value:r.email},{label:"First name",value:r.firstName||""},{label:"Last name",value:r.lastName||""},{label:"Social Media",value:r.socialMediaLink??""},{label:"Website",value:r.websiteLink??""}])},[r]);const c=async()=>{if(!r){z.error("Profile data not found");return}const d={"First name":"firstName","Last name":"lastName","Social Media":"socialMediaLink",Website:"websiteLink"},x=s.reduce((v,N)=>{const P=d[N.label];return P&&N.value&&(P==="createdAt"?v[P]=rt.fromDate(new Date(N.value)):v[P]=N.value),v},{});if(!Object.keys(x).some(v=>x[v]!==r[v])){z("No changes detected. Profile not updated");return}await m(x),f&&z.success("Successfully updated your profile"),i&&z.error("An error occured while updating profile, please try again"),a(!0)};if(o)return e.jsx("div",{children:e.jsx("p",{children:"Profile loading..."})});if(u){z.error(u);return}return e.jsxs("div",{className:"flex flex-col items-center mt-4",children:[e.jsx(Be,{richColors:!0,position:"top-center",className:"text-start"}),e.jsx("div",{children:e.jsxs(H,{className:"md:w-[450px]",children:[e.jsx(B,{children:e.jsx(q,{children:"Profile"})}),e.jsx(K,{children:e.jsx("ul",{className:"flex-col mt-4",children:s.map((d,x)=>e.jsxs("li",{className:"flex gap-1 items-center text-start mb-2 justify-between",children:[e.jsx("label",{className:"w-1/4",children:d.label}),e.jsx(F,{value:d.value,onChange:h=>{const v=[...s];v[x].value=h.target.value,l(v)},disabled:d.label==="Email"||t,className:"w-3/4"})]},d.label))})}),e.jsxs(Ge,{className:"flex justify-between",children:[e.jsx(y,{variant:"link",onClick:()=>{a(!t)},disabled:!t,children:"Edit Profile"}),e.jsx(y,{onClick:c,disabled:n||t,variant:t?"outline":"default",children:"Update Profile"})]})]})})]})},$t=({className:t,...a})=>e.jsx("div",{className:j("flex flex-col gap-6 m-2",t),...a,children:e.jsxs(H,{className:"min-h-svh",children:[e.jsx(B,{children:e.jsx(q,{className:"text-2xl",children:"Organizer Dashboard"})}),e.jsx(K,{children:e.jsx("div",{className:"flex min-h-full w-full items-center justify-center p-2 max-sm:p-0",children:e.jsx("div",{className:"w-full max-w-sm justify-center",children:e.jsxs(ot,{defaultValue:"create-post",className:"w-full",children:[e.jsxs(lt,{className:"grid w-full grid-cols-3",children:[e.jsx(U,{value:"create-post",children:"Create Post"}),e.jsx(U,{value:"post",children:"Posts"}),e.jsx(U,{value:"profile",children:"Profile"})]}),e.jsx(O,{value:"create-post",children:e.jsx(Lt,{})}),e.jsx(O,{value:"post",children:"Previous posts"}),e.jsx(O,{value:"profile",children:e.jsx(Vt,{})})]})})})})]})});function Xt(){const t=se();return g.useEffect(()=>{const a=E.get("auth_token");a?a===void 0&&t("/"):t("/login")},[t]),e.jsxs("div",{children:[e.jsx(Je,{}),e.jsx($t,{}),e.jsx(gt,{})]})}export{Xt as default};
