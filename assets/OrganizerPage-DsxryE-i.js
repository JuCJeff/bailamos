import{u as Q,j as e,F as le,r as u,C as Z,S as ie,d as X,e as ce,I as de,f as ue,g as me,h as Y,i as ee,D as xe,k as fe,l as pe,m as he,T as ge,P as je,n as ve,o as be,V as ye,p as we,q as Ne,s as Ce,t as Se,v as ke,w as Te,x as te,y as Pe,z as Fe,A as ze,E as _e,G as Me,H as Ie,J as De,K as Le,L as Ue,M as Ee,N as Re,O as Ae,Q as Oe,U as P,W as Ve}from"./react-CzuZiG-A.js";import{U as I,V as h,E as $e,y as He}from"./vendor-Dkcwaizg.js";import{B as v,c as x,I as z,b as K,H as Be}from"./HeadBar-BNdaLe86.js";import{s as qe,r as We,u as Ge,g as Ke,a as Je,c as Qe,b as Ze,o as Xe,d as se,e as Ye,f as et,T as tt}from"./firebase-DQYfvhxm.js";import{a as M,L as st,C as A,b as O,c as V,d as $,s as at,e as H,f as rt,T as nt,g as ot,h as L,i as U}from"./config-CZ4-VlkI.js";import{u as lt,A as it,G as ct,M as dt,I as ut}from"./google-maps-W6qen2jQ.js";import"./shadcn-ui-BA32w1ww.js";import"./index-BrtNUJ0w.js";const mt=()=>{const t=Q();return{handleSignOut:async()=>{try{const s=await qe(M);console.log(s),I.remove("auth_token"),t("/login")}catch(s){console.error("Error during sign out: ",s)}}}},xt=()=>{const{handleSignOut:t}=mt();return e.jsx(v,{onClick:t,children:"Log out"})},ft=le,ae=u.createContext({}),T=({...t})=>e.jsx(ae.Provider,{value:{name:t.name},children:e.jsx(Z,{...t})}),B=()=>{const t=u.useContext(ae),a=u.useContext(re),{getFieldState:s}=X(),o=ce({name:t.name}),i=s(t.name,o);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:n}=a;return{id:n,name:t.name,formItemId:`${n}-form-item`,formDescriptionId:`${n}-form-item-description`,formMessageId:`${n}-form-item-message`,...i}},re=u.createContext({});function w({className:t,...a}){const s=u.useId();return e.jsx(re.Provider,{value:{id:s},children:e.jsx("div",{"data-slot":"form-item",className:x("grid gap-2",t),...a})})}function y({className:t,...a}){const{error:s,formItemId:o}=B();return e.jsx(st,{"data-slot":"form-label","data-error":!!s,className:x("data-[error=true]:text-destructive",t),htmlFor:o,...a})}function k({...t}){const{error:a,formItemId:s,formDescriptionId:o,formMessageId:i}=B();return e.jsx(ie,{"data-slot":"form-control",id:s,"aria-describedby":a?`${o} ${i}`:`${o}`,"aria-invalid":!!a,...t})}function N({className:t,...a}){const{error:s,formMessageId:o}=B(),i=s?String((s==null?void 0:s.message)??""):a.children;return i?e.jsx("p",{"data-slot":"form-message",id:o,className:x("text-destructive text-sm",t),...a,children:i}):null}function pt({className:t,...a}){return e.jsx("textarea",{"data-slot":"textarea",className:x("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}const ht=h.object({title:h.string().min(3,"Title is required"),startTime:h.date({required_error:"A date and time is required."}),endTime:h.date({required_error:"A date and time is required."}),price:h.number(),description:h.string().optional(),image:h.instanceof(File).optional(),music:h.array(h.string()).nonempty("Select at least one category"),location:h.object({propertyName:h.string().optional(),address:h.string().optional(),city:h.string().optional(),state:h.string().optional(),googleMapsUrl:h.string().optional(),lat:h.number().optional(),lng:h.number().optional()}).optional()}),gt=({control:t,name:a})=>e.jsx(T,{control:t,name:a,render:({field:s})=>e.jsxs(w,{children:[e.jsx(y,{htmlFor:"imageUpload",children:"Upload Image"}),e.jsx(k,{children:e.jsx(jt,{id:"imageUpload",value:s.value||void 0,onChange:s.onChange})}),e.jsx(N,{})]})}),jt=({id:t,value:a,onChange:s})=>{const[o,i]=u.useState(null),n=u.useRef(null),r=u.useRef(null);u.useEffect(()=>{if(a){const c=URL.createObjectURL(a);n.current=c,i(c)}return()=>{n.current&&URL.revokeObjectURL(n.current)}},[a]);const l=c=>{var m;const d=((m=c[0])==null?void 0:m.file)||void 0;s(d)};return e.jsx(de,{multiple:!1,value:a?[{file:a,data_url:n.current??""}]:[],onChange:l,dataURLKey:"data_url",children:({imageList:c,onImageUpload:d,onImageUpdate:m,onImageRemove:b,isDragging:f,dragProps:g})=>e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("input",{id:t,type:"file",ref:r,className:"hidden",onChange:j=>{var p;(p=j.target.files)!=null&&p[0]&&s(j.target.files[0])}}),e.jsx(v,{type:"button",style:f?{backgroundColor:"limegreen",transitionDuration:"250ms"}:void 0,onClick:d,...g,children:"Click or Drop image here"}),c.map((j,p)=>e.jsxs("div",{children:[e.jsx("img",{src:o??void 0,alt:"event-image",className:"rounded-2xl"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(v,{type:"button",onClick:()=>m(p),children:"Update"}),e.jsx(v,{type:"button",onClick:()=>b(p),children:"Remove"})]})]},j.data_url))]})})},vt=[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]}],bt=["places","marker"],yt={styles:vt,disableDefaultUI:!0,mapTypeControl:!1,fullscreenControl:!1,streetViewControl:!1},F={lat:43.0722,lng:-89.4008},wt=({control:t,name:a})=>{const[s,o]=u.useState(null),[i,n]=u.useState(!1),[r,l]=u.useState(F),c=u.useRef(null),{isLoaded:d}=lt({googleMapsApiKey:"AIzaSyBuImOK6KWeeg3f71cgw6R-ssJj4arkAjk",libraries:bt}),m=b=>{var C,S,q,W,G;if(!c.current)return;const f=c.current.getPlace();if(!((C=f.geometry)!=null&&C.location))return;const g=f.geometry.location.lat(),j=f.geometry.location.lng(),p={propertyName:f.name??"",address:f.formatted_address??"",city:(q=(S=f.address_components)==null?void 0:S.find(D=>D.types.includes("locality")))==null?void 0:q.long_name,state:(G=(W=f.address_components)==null?void 0:W.find(D=>D.types.includes("administrative_area_level_1")))==null?void 0:G.short_name,googleMapsUrl:f.url?f.url:`https://www.google.com/maps/search/?api=1&query=${g},${j}`,lat:g,lng:j};o(p),l({lat:g,lng:j}),b(p)};return d?e.jsx(T,{control:t,name:a,render:({field:b})=>e.jsxs(w,{children:[e.jsx(y,{htmlFor:a,children:"Event Location"}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(it,{onLoad:f=>c.current=f,onPlaceChanged:()=>m(b.onChange),children:e.jsx(z,{id:"location",placeholder:"Search for a location...",className:"w-full"})}),e.jsx("div",{className:"w-full h-72 rounded-md border",children:e.jsxs(ct,{center:r,zoom:15,mapContainerClassName:"w-full h-full rounded-2xl",options:yt,children:[s&&e.jsx(dt,{position:{lat:r.lat??F.lat,lng:r.lng??F.lng},onClick:()=>n(!0)}),s&&i&&e.jsx(ut,{position:{lat:r.lat??F.lat,lng:r.lng??F.lng},onCloseClick:()=>n(!1),children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h3",{className:"font-semibold text-md text-primary",children:s.propertyName}),e.jsx("p",{className:"text-sm text-gray-500",children:s.address}),s.city&&s.state&&e.jsxs("p",{className:"text-sm text-gray-400",children:[s.city,", ",s.state]}),e.jsx("a",{href:s.googleMapsUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary underline text-sm",children:"View on Google Maps"})]})})]})})]})}),e.jsx(N,{})]})}):e.jsx("p",{children:"Loading map..."})};function ne({className:t,...a}){return e.jsx(ue,{"data-slot":"checkbox",className:x("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:e.jsx(me,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(Y,{className:"size-3.5"})})})}const Nt=({control:t,name:a})=>{const{field:{value:s,onChange:o}}=ee({name:a,control:t}),[i,n]=u.useState(s===0),r=c=>{const d=c.target.value?Number(c.target.value):0;o(d),d>0&&n(!1)},l=()=>{const c=!i;n(c),o(c?0:"")};return e.jsxs("div",{className:"space-y-2",children:[!i&&e.jsx(T,{control:t,name:a,render:()=>e.jsxs(w,{children:[e.jsx(y,{htmlFor:"price",children:"Price"}),e.jsx(k,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"pe-1",children:"$"}),e.jsx(z,{placeholder:"Price",id:"price",type:"number",value:s||"",onChange:r})]})}),e.jsx(N,{})]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ne,{id:"freeEvent",checked:i,onCheckedChange:l}),e.jsx("label",{htmlFor:"freeEvent",className:"px-1 text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"This is a free event"})]})]})},oe=[{id:"bachata",label:"Bachata"},{id:"salsa",label:"Salsa"},{id:"merengue",label:"Merengue"},{id:"cumbia",label:"Cumbia"},{id:"zouk",label:"Zouk"},{id:"others",label:"Others"}],Ct=()=>{const{control:t,watch:a}=X(),s=a("music",["bachata","salsa"]);return e.jsx(Z,{control:t,name:"musicPercentages",render:({field:o})=>e.jsxs(w,{className:"space-y-2",children:[e.jsx(y,{className:"text-base",children:"Music Breakdown"}),s.length===0?e.jsx("p",{className:"text-start text-sm text-gray-500",children:"No music categories selected"}):s.map(i=>{var r,l;const n=oe.find(c=>c.id===i);return e.jsxs(w,{className:"flex items-center justify-between gap-2",children:[e.jsx(y,{className:"w-1/3 text-sm font-medium",children:n==null?void 0:n.label}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{children:e.jsx(z,{type:"number",value:((l=(r=o.value)==null?void 0:r[i])==null?void 0:l.percentage)||"",onChange:c=>{const d=Number(c.target.value);o.onChange({...o.value,[i]:{name:(n==null?void 0:n.label)??"",percentage:d}})},placeholder:"0",className:"flex grow"})}),e.jsx("span",{children:"%"})]})]},i)}),e.jsx(N,{})]})})};function St({className:t,classNames:a,showOutsideDays:s=!0,...o}){return e.jsx(xe,{showOutsideDays:s,className:x("p-3",t),classNames:{months:"flex flex-col sm:flex-row gap-2",month:"flex flex-col gap-4",caption:"flex justify-center pt-1 relative items-center w-full",caption_label:"text-sm font-medium",nav:"flex items-center gap-1",nav_button:x(K({variant:"outline"}),"size-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-x-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:x("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-range-end)]:rounded-r-md",o.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:x(K({variant:"ghost"}),"size-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start aria-selected:bg-primary aria-selected:text-primary-foreground",day_range_end:"day-range-end aria-selected:bg-primary aria-selected:text-primary-foreground",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:({className:i,...n})=>e.jsx(pe,{className:x("size-4",i),...n}),IconRight:({className:i,...n})=>e.jsx(fe,{className:x("size-4",i),...n})},...o})}function kt({...t}){return e.jsx(he,{"data-slot":"popover",...t})}function Tt({...t}){return e.jsx(ge,{"data-slot":"popover-trigger",...t})}function Pt({className:t,align:a="center",sideOffset:s=4,...o}){return e.jsx(je,{children:e.jsx(ve,{"data-slot":"popover-content",align:a,sideOffset:s,className:x("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...o})})}function E({className:t,children:a,...s}){return e.jsxs(be,{"data-slot":"scroll-area",className:x("relative",t),...s,children:[e.jsx(ye,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:a}),e.jsx(R,{}),e.jsx(we,{})]})}function R({className:t,orientation:a="vertical",...s}){return e.jsx(Ne,{"data-slot":"scroll-area-scrollbar",orientation:a,className:x("flex touch-none p-px transition-colors select-none",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",t),...s,children:e.jsx(Ce,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function Ft({...t}){return e.jsx(Se,{"data-slot":"select",...t})}function zt({...t}){return e.jsx(Pe,{"data-slot":"select-value",...t})}function _t({className:t,size:a="default",children:s,...o}){return e.jsxs(ke,{"data-slot":"select-trigger","data-size":a,className:x("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...o,children:[s,e.jsx(Te,{asChild:!0,children:e.jsx(te,{className:"size-4 opacity-50"})})]})}function Mt({className:t,children:a,position:s="popper",...o}){return e.jsx(Fe,{children:e.jsxs(ze,{"data-slot":"select-content",className:x("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...o,children:[e.jsx(It,{}),e.jsx(_e,{className:x("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),e.jsx(Dt,{})]})})}function _({className:t,children:a,...s}){return e.jsxs(Me,{"data-slot":"select-item",className:x("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...s,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(Ie,{children:e.jsx(Y,{className:"size-4"})})}),e.jsx(De,{children:a})]})}function It({className:t,...a}){return e.jsx(Le,{"data-slot":"select-scroll-up-button",className:x("flex cursor-default items-center justify-center py-1",t),...a,children:e.jsx(Ue,{className:"size-4"})})}function Dt({className:t,...a}){return e.jsx(Ee,{"data-slot":"select-scroll-down-button",className:x("flex cursor-default items-center justify-center py-1",t),...a,children:e.jsx(te,{className:"size-4"})})}function J({form:t,label:a,formFieldName:s}){function o(r){r&&t.setValue(s,r)}function i(r){const l=He(new Date,parseInt(r)),c=t.getValues(s);c?l.setHours(c.getHours(),c.getMinutes(),c.getSeconds()):l.setHours(0,0,0,0),t.setValue(s,l)}function n(r,l){const c=t.getValues(s)||new Date,d=new Date(c);if(r==="hour"){const m=parseInt(l,10);d.getHours()>=12?d.setHours(m+12):d.setHours(m%12)}else if(r==="minute")d.setMinutes(parseInt(l,10));else if(r==="ampm"){const m=d.getHours();l==="AM"&&m>=12?d.setHours(m-12):l==="PM"&&m<12&&d.setHours(m+12)}t.setValue(s,d)}return e.jsx(T,{control:t.control,name:s,render:({field:r})=>e.jsxs(w,{className:"flex flex-col",children:[e.jsx(y,{children:a}),e.jsxs(kt,{children:[e.jsx(Tt,{asChild:!0,children:e.jsx(k,{children:e.jsxs(v,{variant:"outline",className:x("w-full pl-3 text-left font-normal",!r.value&&"text-muted-foreground"),children:[r.value?$e(r.value,"MM/dd/yyyy hh:mm aa"):e.jsx("span",{children:"Select date and time"}),e.jsx(Re,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(Pt,{className:"w-auto p-2",children:e.jsxs("div",{className:"flex-col sm:flex",children:[e.jsx("div",{children:e.jsxs(Ft,{onValueChange:i,children:[e.jsx(_t,{children:e.jsx(zt,{placeholder:"Select"})}),e.jsxs(Mt,{position:"popper",children:[e.jsx(_,{value:"0",children:"Today"}),e.jsx(_,{value:"1",children:"Tomorrow"}),e.jsx(_,{value:"3",children:"In 3 days"}),e.jsx(_,{value:"7",children:"In a week"})]})]})}),e.jsxs("div",{className:"sm:flex",children:[e.jsx(St,{mode:"single",selected:r.value,onSelect:o,initialFocus:!0}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:h-[300px] divide-y sm:divide-y-0 sm:divide-x",children:[e.jsxs(E,{className:"w-64 sm:w-auto",children:[e.jsx("div",{className:"flex sm:flex-col p-2",children:Array.from({length:12},(l,c)=>c+1).reverse().map(l=>e.jsx(v,{size:"icon",variant:r.value&&r.value.getHours()%12===l%12?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>n("hour",l.toString()),children:l},l))}),e.jsx(R,{orientation:"horizontal",className:"sm:hidden"})]}),e.jsxs(E,{className:"w-64 sm:w-auto",children:[e.jsx("div",{className:"flex sm:flex-col p-2",children:Array.from({length:12},(l,c)=>c*5).map(l=>e.jsx(v,{size:"icon",variant:r.value&&r.value.getMinutes()===l?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>n("minute",l.toString()),children:l.toString().padStart(2,"0")},l))}),e.jsx(R,{orientation:"horizontal",className:"sm:hidden"})]}),e.jsx(E,{className:"",children:e.jsx("div",{className:"flex sm:flex-col p-2",children:["AM","PM"].map(l=>e.jsx(v,{size:"icon",variant:r.value&&(l==="AM"&&r.value.getHours()<12||l==="PM"&&r.value.getHours()>=12)?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>n("ampm",l),children:l},l))})})]})]})]})})]}),e.jsx(N,{})]})})}const Lt=({control:t,name:a})=>{const{field:{value:s,onChange:o}}=ee({name:a,control:t}),i=(n,r)=>{const l=n?[...s||[],r]:(s==null?void 0:s.filter(c=>c!==r))||[];o(l)};return e.jsxs(w,{children:[e.jsx(y,{className:"text-base",children:"Music"}),oe.map(n=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{id:n.id,checked:s==null?void 0:s.includes(n.id),onCheckedChange:r=>i(!!r,n.id)}),e.jsx(y,{htmlFor:n.id,className:"text-sm font-normal",children:n.label})]},n.id)),e.jsx(N,{})]})},Ut=({className:t,...a})=>{const[s,o]=u.useState(!1),i=Ae({resolver:Oe(ht),defaultValues:{music:["bachata","salsa"],location:{}}}),n=async r=>{o(!0);let l="";if(r.image){const c=We(at,`events/${Date.now()}-${r.image.name}`);await Ge(c,r.image),l=await Ke(c)}await Je(Qe(H,"events"),{title:r.title,startTime:r.startTime,endTime:r.endTime,imageUrl:l,description:r.description,price:r.price,music:r.music,location:r.location,organizerId:"",createdAt:Ze()}),o(!1)};return e.jsx("div",{className:x("flex flex-col gap-6 m-2",t),...a,children:e.jsxs(A,{children:[e.jsx(O,{children:e.jsx(V,{className:"text-2xl",children:"Create Event"})}),e.jsx($,{children:e.jsx(ft,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(n),className:"flex flex-col justify-center py-2 gap-4",children:[e.jsx(T,{control:i.control,name:"title",render:({field:r})=>e.jsxs(w,{children:[e.jsx(y,{htmlFor:"title",children:"Title"}),e.jsx(k,{children:e.jsx(z,{id:"title",placeholder:"Dance Social",...r})}),e.jsx(N,{})]})}),e.jsx(wt,{control:i.control,name:"location"}),e.jsx(J,{form:i,label:"Start time",formFieldName:"startTime"}),e.jsx(J,{form:i,label:"End time",formFieldName:"endTime"}),e.jsx(gt,{control:i.control,name:"image"}),e.jsx(T,{control:i.control,name:"description",render:({field:r})=>e.jsxs(w,{children:[e.jsx(y,{children:"Description"}),e.jsx(k,{children:e.jsx(pt,{placeholder:"Type the event description here",...r})}),e.jsx(N,{})]})}),e.jsx(Nt,{control:i.control,name:"price"}),e.jsx(Lt,{control:i.control,name:"music"}),e.jsx(Ct,{}),e.jsx(v,{type:"submit",disabled:s,children:s?"Submitting...":"Post Event"})]})})})]})})},Et=()=>{const[t,a]=u.useState(!0),[s,o]=u.useState(null),[i,n]=u.useState(null);return u.useEffect(()=>{if(I.get("auth_token")){const l=Xe(M,async c=>{if(c){const d=se(H,"organizers",c.uid),m=await Ye(d);m.exists()?n(m.data()):o("No organizer data found")}else o("User not authenticated");a(!1)});return()=>l()}else a(!1),o("No authentication token found. Please log in")},[]),{loading:t,error:s,profileData:i}},Rt=()=>{const[t,a]=u.useState(!1),[s,o]=u.useState(null),[i,n]=u.useState(!1);return{loading:t,error:s,success:i,updateProfile:async l=>{var d;if(a(!0),o(null),n(!1),I.get("auth_token"))try{await((d=M.currentUser)==null?void 0:d.getIdToken(!0));const m=M.currentUser;if(m){const b=se(H,"organizers",m.uid);await et(b,l),n(!0)}else o("User not authenticated")}catch(m){console.error("Error updating profile:",m),o("Failed to update profile. Please try again.")}finally{a(!1)}else a(!1),o("No authentication token found. Please log in again.")}}},At=()=>{const[t,a]=u.useState(!0),[s,o]=u.useState([]),{loading:i,error:n,profileData:r}=Et(),{loading:l,error:c,success:d,updateProfile:m}=Rt();u.useEffect(()=>{r&&o([{label:"Email",value:r.email},{label:"First name",value:r.firstName||""},{label:"Last name",value:r.lastName||""},{label:"Social Media",value:r.socialMediaLink??""},{label:"Website",value:r.websiteLink??""}])},[r]);const b=async()=>{if(!r){P.error("Profile data not found");return}const f={"First name":"firstName","Last name":"lastName","Social Media":"socialMediaLink",Website:"websiteLink"},g=s.reduce((p,C)=>{const S=f[C.label];return S&&C.value&&(S==="createdAt"?p[S]=tt.fromDate(new Date(C.value)):p[S]=C.value),p},{});if(!Object.keys(g).some(p=>g[p]!==r[p])){P("No changes detected. Profile not updated");return}await m(g),d&&P.success("Successfully updated your profile"),c&&P.error("An error occured while updating profile, please try again"),a(!0)};if(i)return e.jsx("div",{children:e.jsx("p",{children:"Profile loading..."})});if(n){P.error(n);return}return e.jsxs("div",{className:"flex flex-col items-center mt-4",children:[e.jsx(Ve,{richColors:!0,position:"top-center",className:"text-start"}),e.jsx("div",{children:e.jsxs(A,{className:"md:w-[450px]",children:[e.jsx(O,{children:e.jsx(V,{children:"Profile"})}),e.jsx($,{children:e.jsx("ul",{className:"flex-col mt-4",children:s.map((f,g)=>e.jsxs("li",{className:"flex gap-1 items-center text-start mb-2 justify-between",children:[e.jsx("label",{className:"w-1/4",children:f.label}),e.jsx(z,{value:f.value,onChange:j=>{const p=[...s];p[g].value=j.target.value,o(p)},disabled:f.label==="Email"||t,className:"w-3/4"})]},f.label))})}),e.jsxs(rt,{className:"flex justify-between",children:[e.jsx(v,{variant:"link",onClick:()=>{a(!t)},disabled:!t,children:"Edit Profile"}),e.jsx(v,{onClick:b,disabled:l||t,variant:t?"outline":"default",children:"Update Profile"})]})]})})]})},Ot=({className:t,...a})=>e.jsx("div",{className:x("flex flex-col gap-6 m-2",t),...a,children:e.jsxs(A,{className:"min-h-svh",children:[e.jsx(O,{children:e.jsx(V,{className:"text-2xl",children:"Organizer Dashboard"})}),e.jsx($,{children:e.jsx("div",{className:"flex min-h-full w-full items-center justify-center p-2 max-sm:p-0",children:e.jsx("div",{className:"w-full max-w-sm justify-center",children:e.jsxs(nt,{defaultValue:"create-post",className:"w-full",children:[e.jsxs(ot,{className:"grid w-full grid-cols-3",children:[e.jsx(L,{value:"create-post",children:"Create Post"}),e.jsx(L,{value:"post",children:"Posts"}),e.jsx(L,{value:"profile",children:"Profile"})]}),e.jsx(U,{value:"create-post",children:e.jsx(Ut,{})}),e.jsx(U,{value:"post",children:"Previous posts"}),e.jsx(U,{value:"profile",children:e.jsx(At,{})})]})})})})]})});function Jt(){const t=Q();return u.useEffect(()=>{const a=I.get("auth_token");a?a===void 0&&t("/"):t("/login")},[t]),e.jsxs("div",{children:[e.jsx(Be,{}),e.jsx(Ot,{}),e.jsx(xt,{})]})}export{Jt as default};
