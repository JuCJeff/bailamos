import{u as X,j as e,d as he,I as ge,C as Y,F as je,r as m,e as R,S as ve,f as ee,g as be,D as ye,h as we,i as Ne,k as Ce,T as Se,P as ke,l as Te,m as Pe,n as ze,o as _e,p as te,V as Ie,q as Fe,s as De,t as Me,v as Le,w as Ue,x as Ee,y as Ae,z as Re,A as Ve,E as Oe,G as $e,H as He,J as Be,K as qe,L as We,M as Ge,N as Ke,O as Je,Q as Qe,U as z,W as Ze}from"./react-BMBqGnwi.js";import{U as D,V as h,E as ae,y as se}from"./vendor-Dkcwaizg.js";import{B as v,c as x,b as J,I,H as Xe}from"./HeadBar-C5J7Al3O.js";import{s as Ye,r as et,u as tt,g as at,a as st,c as rt,b as nt,o as lt,d as re,e as ot,f as it,T as ct}from"./firebase-DQYfvhxm.js";import{a as F,L as dt,C as V,b as O,c as $,d as H,s as ut,e as B,f as mt,T as xt,g as pt,h as L,i as U}from"./config-CVqAQe_C.js";import{u as ft,A as ht,G as gt,M as jt,I as vt}from"./google-maps-xTCbtLdc.js";import"./shadcn-ui-BA32w1ww.js";import"./index-D9OJGF1f.js";const bt=()=>{const t=X();return{handleSignOut:async()=>{try{const a=await Ye(F);console.log(a),D.remove("auth_token"),t("/login")}catch(a){console.error("Error during sign out: ",a)}}}},yt=()=>{const{handleSignOut:t}=bt();return e.jsx(v,{onClick:t,children:"Log out"})};function Q({className:t,...s}){return e.jsx(he,{"data-slot":"checkbox",className:x("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e.jsx(ge,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(Y,{className:"size-3.5"})})})}const wt=je,ne=m.createContext({}),S=({...t})=>e.jsx(ne.Provider,{value:{name:t.name},children:e.jsx(R,{...t})}),q=()=>{const t=m.useContext(ne),s=m.useContext(le),{getFieldState:a}=ee(),o=be({name:t.name}),i=a(t.name,o);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:c}=s;return{id:c,name:t.name,formItemId:`${c}-form-item`,formDescriptionId:`${c}-form-item-description`,formMessageId:`${c}-form-item-message`,...i}},le=m.createContext({});function b({className:t,...s}){const a=m.useId();return e.jsx(le.Provider,{value:{id:a},children:e.jsx("div",{"data-slot":"form-item",className:x("grid gap-2",t),...s})})}function y({className:t,...s}){const{error:a,formItemId:o}=q();return e.jsx(dt,{"data-slot":"form-label","data-error":!!a,className:x("data-[error=true]:text-destructive",t),htmlFor:o,...s})}function w({...t}){const{error:s,formItemId:a,formDescriptionId:o,formMessageId:i}=q();return e.jsx(ve,{"data-slot":"form-control",id:a,"aria-describedby":s?`${o} ${i}`:`${o}`,"aria-invalid":!!s,...t})}function N({className:t,...s}){const{error:a,formMessageId:o}=q(),i=a?String((a==null?void 0:a.message)??""):s.children;return i?e.jsx("p",{"data-slot":"form-message",id:o,className:x("text-destructive text-sm",t),...s,children:i}):null}function Nt({className:t,...s}){return e.jsx("textarea",{"data-slot":"textarea",className:x("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}const Ct=h.object({title:h.string().min(3,"Title is required"),date:h.date(),startTime:h.date({required_error:"A date and time is required."}),endTime:h.date({required_error:"A date and time is required."}),price:h.number(),description:h.string().optional(),image:h.instanceof(File).optional(),music:h.array(h.string()).nonempty("Select at least one category"),location:h.object({propertyName:h.string().optional(),address:h.string().optional(),city:h.string().optional(),state:h.string().optional(),googleMapsUrl:h.string().optional(),lat:h.number().optional(),lng:h.number().optional()}).optional()});function oe({className:t,classNames:s,showOutsideDays:a=!0,...o}){return e.jsx(ye,{showOutsideDays:a,className:x("p-3",t),classNames:{months:"flex flex-col sm:flex-row gap-2",month:"flex flex-col gap-4",caption:"flex justify-center pt-1 relative items-center w-full",caption_label:"text-sm font-medium",nav:"flex items-center gap-1",nav_button:x(J({variant:"outline"}),"size-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-x-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:x("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-range-end)]:rounded-r-md",o.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:x(J({variant:"ghost"}),"size-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start aria-selected:bg-primary aria-selected:text-primary-foreground",day_range_end:"day-range-end aria-selected:bg-primary aria-selected:text-primary-foreground",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:({className:i,...c})=>e.jsx(Ne,{className:x("size-4",i),...c}),IconRight:({className:i,...c})=>e.jsx(we,{className:x("size-4",i),...c})},...o})}function ie({...t}){return e.jsx(Ce,{"data-slot":"popover",...t})}function ce({...t}){return e.jsx(Se,{"data-slot":"popover-trigger",...t})}function de({className:t,align:s="center",sideOffset:a=4,...o}){return e.jsx(ke,{children:e.jsx(Te,{"data-slot":"popover-content",align:s,sideOffset:a,className:x("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...o})})}function ue({...t}){return e.jsx(Pe,{"data-slot":"select",...t})}function me({...t}){return e.jsx(Ie,{"data-slot":"select-value",...t})}function xe({className:t,size:s="default",children:a,...o}){return e.jsxs(ze,{"data-slot":"select-trigger","data-size":s,className:x("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...o,children:[a,e.jsx(_e,{asChild:!0,children:e.jsx(te,{className:"size-4 opacity-50"})})]})}function pe({className:t,children:s,position:a="popper",...o}){return e.jsx(Fe,{children:e.jsxs(De,{"data-slot":"select-content",className:x("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...o,children:[e.jsx(St,{}),e.jsx(Me,{className:x("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),e.jsx(kt,{})]})})}function k({className:t,children:s,...a}){return e.jsxs(Le,{"data-slot":"select-item",className:x("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...a,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(Ue,{children:e.jsx(Y,{className:"size-4"})})}),e.jsx(Ee,{children:s})]})}function St({className:t,...s}){return e.jsx(Ae,{"data-slot":"select-scroll-up-button",className:x("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Re,{className:"size-4"})})}function kt({className:t,...s}){return e.jsx(Ve,{"data-slot":"select-scroll-down-button",className:x("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(te,{className:"size-4"})})}const Tt=({value:t,onChange:s})=>e.jsxs(ie,{children:[e.jsx(ce,{asChild:!0,children:e.jsxs(v,{variant:"outline",className:x("w-[240px] justify-start text-left font-normal",!t&&"text-muted-foreground"),"aria-labelledby":"date-label",children:[e.jsx(Oe,{}),t?ae(t,"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsxs(de,{align:"start",className:"flex w-auto flex-col space-y-2 p-2",children:[e.jsxs(ue,{onValueChange:a=>s(se(new Date,parseInt(a))),children:[e.jsx(xe,{children:e.jsx(me,{placeholder:"Select"})}),e.jsxs(pe,{position:"popper",children:[e.jsx(k,{value:"0",children:"Today"}),e.jsx(k,{value:"1",children:"Tomorrow"}),e.jsx(k,{value:"3",children:"In 3 days"}),e.jsx(k,{value:"7",children:"In a week"})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsx(oe,{mode:"single",selected:t,onSelect:a=>{a&&s(a)},"aria-label":"Select a date"})})]})]}),Pt=({value:t,onChange:s})=>{const[a,o]=m.useState(null),i=m.useRef(null);m.useEffect(()=>{if(t){const r=URL.createObjectURL(t);i.current=r,o(r)}return()=>{i.current&&URL.revokeObjectURL(i.current)}},[t]);const c=r=>{var u;const l=((u=r[0])==null?void 0:u.file)||void 0;s(l)};return e.jsx($e,{multiple:!1,value:t?[{file:t,data_url:i.current??""}]:[],onChange:c,dataURLKey:"data_url",children:({imageList:r,onImageUpload:l,onImageUpdate:u,onImageRemove:n,isDragging:d,dragProps:f})=>e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(v,{type:"button",style:d?{backgroundColor:"limegreen",transitionDuration:"250ms"}:void 0,onClick:l,...f,children:"Click or Drop image here"}),r.map((p,g)=>e.jsxs("div",{children:[e.jsx("img",{src:a??void 0,alt:"event-image",className:"rounded-2xl"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(v,{type:"button",onClick:()=>u(g),children:"Update"}),e.jsx(v,{type:"button",onClick:()=>n(g),children:"Remove"})]})]},p.data_url))]})})},zt=[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]}],_t=["places","marker"],It={styles:zt,disableDefaultUI:!0,mapTypeControl:!1,fullscreenControl:!1,streetViewControl:!1},_={lat:43.0722,lng:-89.4008},Ft=({control:t,name:s})=>{const[a,o]=m.useState(null),[i,c]=m.useState(!1),[r,l]=m.useState(_),u=m.useRef(null),{isLoaded:n}=ft({googleMapsApiKey:"AIzaSyBuImOK6KWeeg3f71cgw6R-ssJj4arkAjk",libraries:_t}),d=f=>{var T,P,W,G,K;if(!u.current)return;const p=u.current.getPlace();if(!((T=p.geometry)!=null&&T.location))return;const g=p.geometry.location.lat(),C=p.geometry.location.lng(),j={propertyName:p.name??"",address:p.formatted_address??"",city:(W=(P=p.address_components)==null?void 0:P.find(M=>M.types.includes("locality")))==null?void 0:W.long_name,state:(K=(G=p.address_components)==null?void 0:G.find(M=>M.types.includes("administrative_area_level_1")))==null?void 0:K.short_name,googleMapsUrl:p.url?p.url:`https://www.google.com/maps/search/?api=1&query=${g},${C}`,lat:g,lng:C};o(j),l({lat:g,lng:C}),f(j)};return n?e.jsx(R,{name:s,control:t,render:({field:f})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(ht,{onLoad:p=>u.current=p,onPlaceChanged:()=>d(f.onChange),children:e.jsx(I,{id:"location",placeholder:"Search for a location...",className:"w-full"})}),e.jsx("div",{className:"w-full h-72 rounded-md border",children:e.jsxs(gt,{center:r,zoom:15,mapContainerClassName:"w-full h-full rounded-2xl",options:It,children:[a&&e.jsx(jt,{position:{lat:r.lat??_.lat,lng:r.lng??_.lng},onClick:()=>c(!0)}),a&&i&&e.jsx(vt,{position:{lat:r.lat??_.lat,lng:r.lng??_.lng},onCloseClick:()=>c(!1),children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h3",{className:"font-semibold text-md text-primary",children:a.propertyName}),e.jsx("p",{className:"text-sm text-gray-500",children:a.address}),a.city&&a.state&&e.jsxs("p",{className:"text-sm text-gray-400",children:[a.city,", ",a.state]}),e.jsx("a",{href:a.googleMapsUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary underline text-sm",children:"View on Google Maps"})]})})]})})]})}):e.jsx("p",{children:"Loading map..."})},fe=[{id:"bachata",label:"Bachata"},{id:"salsa",label:"Salsa"},{id:"merengue",label:"Merengue"},{id:"cumbia",label:"Cumbia"},{id:"zouk",label:"Zouk"},{id:"others",label:"Others"}],Dt=()=>{const{control:t,watch:s}=ee(),a=s("music",["bachata","salsa"]);return e.jsx(R,{control:t,name:"musicPercentages",render:({field:o})=>e.jsxs(b,{className:"space-y-2",children:[e.jsx(y,{className:"text-base",children:"Music Breakdown"}),a.length===0?e.jsx("p",{className:"text-start text-sm text-gray-500",children:"No music categories selected"}):a.map(i=>{var r,l;const c=fe.find(u=>u.id===i);return e.jsxs(b,{className:"flex items-center justify-between gap-2",children:[e.jsx(y,{className:"w-1/3 text-sm font-medium",children:c==null?void 0:c.label}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(w,{children:e.jsx(I,{type:"number",value:((l=(r=o.value)==null?void 0:r[i])==null?void 0:l.percentage)||"",onChange:u=>{const n=Number(u.target.value);o.onChange({...o.value,[i]:{name:(c==null?void 0:c.label)??"",percentage:n}})},placeholder:"0",className:"flex grow"})}),e.jsx("span",{children:"%"})]})]},i)}),e.jsx(N,{})]})})};function E({className:t,children:s,...a}){return e.jsxs(He,{"data-slot":"scroll-area",className:x("relative",t),...a,children:[e.jsx(Be,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:s}),e.jsx(A,{}),e.jsx(qe,{})]})}function A({className:t,orientation:s="vertical",...a}){return e.jsx(We,{"data-slot":"scroll-area-scrollbar",orientation:s,className:x("flex touch-none p-px transition-colors select-none",s==="vertical"&&"h-full w-2.5 border-l border-l-transparent",s==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",t),...a,children:e.jsx(Ge,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function Z({form:t,label:s,formFieldName:a}){function o(r){r&&t.setValue(a,r)}function i(r){const l=se(new Date,parseInt(r)),u=t.getValues(a);u?l.setHours(u.getHours(),u.getMinutes(),u.getSeconds()):l.setHours(0,0,0,0),t.setValue(a,l)}function c(r,l){const u=t.getValues(a)||new Date,n=new Date(u);if(r==="hour"){const d=parseInt(l,10);n.getHours()>=12?n.setHours(d+12):n.setHours(d%12)}else if(r==="minute")n.setMinutes(parseInt(l,10));else if(r==="ampm"){const d=n.getHours();l==="AM"&&d>=12?n.setHours(d-12):l==="PM"&&d<12&&n.setHours(d+12)}t.setValue(a,n)}return e.jsx(S,{control:t.control,name:a,render:({field:r})=>e.jsxs(b,{className:"flex flex-col",children:[e.jsx(y,{children:s}),e.jsxs(ie,{children:[e.jsx(ce,{asChild:!0,children:e.jsx(w,{children:e.jsxs(v,{variant:"outline",className:x("w-full pl-3 text-left font-normal",!r.value&&"text-muted-foreground"),children:[r.value?ae(r.value,"MM/dd/yyyy hh:mm aa"):e.jsx("span",{children:"Select date and time"}),e.jsx(Ke,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(de,{className:"w-auto p-2",children:e.jsxs("div",{className:"flex-col sm:flex",children:[e.jsx("div",{children:e.jsxs(ue,{onValueChange:i,children:[e.jsx(xe,{children:e.jsx(me,{placeholder:"Select"})}),e.jsxs(pe,{position:"popper",children:[e.jsx(k,{value:"0",children:"Today"}),e.jsx(k,{value:"1",children:"Tomorrow"}),e.jsx(k,{value:"3",children:"In 3 days"}),e.jsx(k,{value:"7",children:"In a week"})]})]})}),e.jsxs("div",{className:"sm:flex",children:[e.jsx(oe,{mode:"single",selected:r.value,onSelect:o,initialFocus:!0}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:h-[300px] divide-y sm:divide-y-0 sm:divide-x",children:[e.jsxs(E,{className:"w-64 sm:w-auto",children:[e.jsx("div",{className:"flex sm:flex-col p-2",children:Array.from({length:12},(l,u)=>u+1).reverse().map(l=>e.jsx(v,{size:"icon",variant:r.value&&r.value.getHours()%12===l%12?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>c("hour",l.toString()),children:l},l))}),e.jsx(A,{orientation:"horizontal",className:"sm:hidden"})]}),e.jsxs(E,{className:"w-64 sm:w-auto",children:[e.jsx("div",{className:"flex sm:flex-col p-2",children:Array.from({length:12},(l,u)=>u*5).map(l=>e.jsx(v,{size:"icon",variant:r.value&&r.value.getMinutes()===l?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>c("minute",l.toString()),children:l.toString().padStart(2,"0")},l))}),e.jsx(A,{orientation:"horizontal",className:"sm:hidden"})]}),e.jsx(E,{className:"",children:e.jsx("div",{className:"flex sm:flex-col p-2",children:["AM","PM"].map(l=>e.jsx(v,{size:"icon",variant:r.value&&(l==="AM"&&r.value.getHours()<12||l==="PM"&&r.value.getHours()>=12)?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>c("ampm",l),children:l},l))})})]})]})]})})]}),e.jsx(N,{})]})})}const Mt=({className:t,...s})=>{const[a,o]=m.useState(!1),[i,c]=m.useState(!1),r=Je({resolver:Qe(Ct),defaultValues:{music:["bachata","salsa"],location:{}}}),l=r.watch(),u=async n=>{o(!0);let d="";if(n.image){const f=et(ut,`events/${Date.now()}-${n.image.name}`);await tt(f,n.image),d=await at(f)}await st(rt(B,"events"),{title:n.title,date:n.date,startTime:n.startTime,endTime:n.endTime,imageUrl:d,description:n.description,price:n.price,music:n.music,location:n.location,organizerId:"",createdAt:nt()}),o(!1)};return e.jsx("div",{className:x("flex flex-col gap-6 m-2",t),...s,children:e.jsxs(V,{children:[e.jsx(O,{children:e.jsx($,{className:"text-2xl",children:"Create Event"})}),e.jsx(H,{children:e.jsx(wt,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(u),className:"flex flex-col justify-center py-2 gap-4",children:[e.jsx(S,{control:r.control,name:"title",render:({field:n})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"title",children:"Title"}),e.jsx(w,{children:e.jsx(I,{id:"title",placeholder:"Dance Social",...n})}),e.jsx(N,{})]})}),e.jsx(S,{control:r.control,name:"location",render:({field:n})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"location",children:"Event Location"}),e.jsx(w,{children:e.jsx(Ft,{control:r.control,...n})}),e.jsx(N,{})]})}),e.jsx(Z,{form:r,label:"Start time",formFieldName:"startTime"}),e.jsx(Z,{form:r,label:"End time",formFieldName:"endTime"}),e.jsx(S,{control:r.control,name:"date",render:({field:n})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"date",id:"date-label",children:"Date"}),e.jsx(w,{children:e.jsx(Tt,{value:n.value,onChange:n.onChange,"aria-describedby":"date-error"})}),e.jsx(N,{id:"date-error"})]})}),e.jsx(S,{control:r.control,name:"image",render:({field:n})=>e.jsxs(b,{children:[e.jsx(y,{children:"Upload Image"}),e.jsx(w,{children:e.jsx(Pt,{value:n.value||void 0,onChange:n.onChange})}),e.jsx(N,{})]})}),e.jsx(S,{control:r.control,name:"description",render:({field:n})=>e.jsxs(b,{children:[e.jsx(y,{children:"Description"}),e.jsx(w,{children:e.jsx(Nt,{placeholder:"Type the event description here",...n})}),e.jsx(N,{})]})}),!i&&e.jsx(S,{control:r.control,name:"price",render:({field:n})=>e.jsxs(b,{children:[e.jsx(y,{htmlFor:"price",children:"Price"}),e.jsx(w,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"pe-1",children:"$"}),e.jsx(I,{placeholder:"Price",id:"price",type:"number",value:n.value||"",onChange:d=>{const f=d.target.value?Number(d.target.value):0;n.onChange(f)}})]})}),e.jsx(N,{})]})}),e.jsxs("div",{className:"flex",children:[e.jsx(Q,{id:"freeEvent",checked:i,onCheckedChange:()=>{c(!i),r.setValue("price",0)}}),e.jsx("label",{htmlFor:"freeEvent",className:"px-1 text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"This is a free event"})]}),e.jsxs(b,{children:[e.jsx(y,{className:"text-base",children:"Music"}),fe.map(n=>e.jsx(S,{control:r.control,name:"music",render:({field:d})=>{var f;return e.jsxs(b,{className:"flex flex-row items-center",children:[e.jsx(w,{children:e.jsx(Q,{checked:(f=d.value)==null?void 0:f.includes(n.id),onCheckedChange:p=>{var g;return p?d.onChange([...d.value,n.id]):d.onChange((g=d.value)==null?void 0:g.filter(C=>C!==n.id))}})}),e.jsx(y,{className:"text-sm font-normal",children:n.label})]},n.id)}},n.id)),e.jsx(N,{})]}),e.jsx(Dt,{}),e.jsx("pre",{className:"text-start bg-gray-100 p-2 rounded-md text-sm overflow-auto",children:JSON.stringify({...l,image:l.image?l.image.name:"No image",startTime:l.startTime?l.startTime.toLocaleString():"No start time",endTime:l.endTime?l.endTime.toLocaleString():"No start time"},null,2)}),e.jsx(v,{type:"submit",disabled:a,children:a?"Submitting...":"Post Event"})]})})})]})})},Lt=()=>{const[t,s]=m.useState(!0),[a,o]=m.useState(null),[i,c]=m.useState(null);return m.useEffect(()=>{if(D.get("auth_token")){const l=lt(F,async u=>{if(u){const n=re(B,"organizers",u.uid),d=await ot(n);d.exists()?c(d.data()):o("No organizer data found")}else o("User not authenticated");s(!1)});return()=>l()}else s(!1),o("No authentication token found. Please log in")},[]),{loading:t,error:a,profileData:i}},Ut=()=>{const[t,s]=m.useState(!1),[a,o]=m.useState(null),[i,c]=m.useState(!1);return{loading:t,error:a,success:i,updateProfile:async l=>{var n;if(s(!0),o(null),c(!1),D.get("auth_token"))try{await((n=F.currentUser)==null?void 0:n.getIdToken(!0));const d=F.currentUser;if(d){const f=re(B,"organizers",d.uid);await it(f,l),c(!0)}else o("User not authenticated")}catch(d){console.error("Error updating profile:",d),o("Failed to update profile. Please try again.")}finally{s(!1)}else s(!1),o("No authentication token found. Please log in again.")}}},Et=()=>{const[t,s]=m.useState(!0),[a,o]=m.useState([]),{loading:i,error:c,profileData:r}=Lt(),{loading:l,error:u,success:n,updateProfile:d}=Ut();m.useEffect(()=>{r&&o([{label:"Email",value:r.email},{label:"First name",value:r.firstName||""},{label:"Last name",value:r.lastName||""},{label:"Social Media",value:r.socialMediaLink??""},{label:"Website",value:r.websiteLink??""}])},[r]);const f=async()=>{if(!r){z.error("Profile data not found");return}const p={"First name":"firstName","Last name":"lastName","Social Media":"socialMediaLink",Website:"websiteLink"},g=a.reduce((j,T)=>{const P=p[T.label];return P&&T.value&&(P==="createdAt"?j[P]=ct.fromDate(new Date(T.value)):j[P]=T.value),j},{});if(!Object.keys(g).some(j=>g[j]!==r[j])){z("No changes detected. Profile not updated");return}await d(g),n&&z.success("Successfully updated your profile"),u&&z.error("An error occured while updating profile, please try again"),s(!0)};if(i)return e.jsx("div",{children:e.jsx("p",{children:"Profile loading..."})});if(c){z.error(c);return}return e.jsxs("div",{className:"flex flex-col items-center mt-4",children:[e.jsx(Ze,{richColors:!0,position:"top-center",className:"text-start"}),e.jsx("div",{children:e.jsxs(V,{className:"md:w-[450px]",children:[e.jsx(O,{children:e.jsx($,{children:"Profile"})}),e.jsx(H,{children:e.jsx("ul",{className:"flex-col mt-4",children:a.map((p,g)=>e.jsxs("li",{className:"flex gap-1 items-center text-start mb-2 justify-between",children:[e.jsx("label",{className:"w-1/4",children:p.label}),e.jsx(I,{value:p.value,onChange:C=>{const j=[...a];j[g].value=C.target.value,o(j)},disabled:p.label==="Email"||t,className:"w-3/4"})]},p.label))})}),e.jsxs(mt,{className:"flex justify-between",children:[e.jsx(v,{variant:"link",onClick:()=>{s(!t)},disabled:!t,children:"Edit Profile"}),e.jsx(v,{onClick:f,disabled:l||t,variant:t?"outline":"default",children:"Update Profile"})]})]})})]})},At=({className:t,...s})=>e.jsx("div",{className:x("flex flex-col gap-6 m-2",t),...s,children:e.jsxs(V,{className:"min-h-svh",children:[e.jsx(O,{children:e.jsx($,{className:"text-2xl",children:"Organizer Dashboard"})}),e.jsx(H,{children:e.jsx("div",{className:"flex min-h-full w-full items-center justify-center p-2 max-sm:p-0",children:e.jsx("div",{className:"w-full max-w-sm justify-center",children:e.jsxs(xt,{defaultValue:"create-post",className:"w-full",children:[e.jsxs(pt,{className:"grid w-full grid-cols-3",children:[e.jsx(L,{value:"create-post",children:"Create Post"}),e.jsx(L,{value:"post",children:"Posts"}),e.jsx(L,{value:"profile",children:"Profile"})]}),e.jsx(U,{value:"create-post",children:e.jsx(Mt,{})}),e.jsx(U,{value:"post",children:"Previous posts"}),e.jsx(U,{value:"profile",children:e.jsx(Et,{})})]})})})})]})});function Gt(){const t=X();return m.useEffect(()=>{const s=D.get("auth_token");s?s===void 0&&t("/"):t("/login")},[t]),e.jsxs("div",{children:[e.jsx(Xe,{}),e.jsx(At,{}),e.jsx(yt,{})]})}export{Gt as default};
