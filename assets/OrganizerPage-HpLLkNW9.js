import{u as ae,j as e,F as ue,r as m,C as A,S as me,d as H,e as xe,I as fe,f as ge,g as he,h as re,i as ne,D as pe,k as je,l as ve,m as be,T as ye,P as we,n as Ne,o as Se,V as Ce,p as Pe,q as ke,s as ze,t as Fe,v as Te,w as Ee,x as oe,y as _e,z as Le,A as Me,E as De,G as Ie,H as Ue,J as Oe,K as Ve,L as Ae,M as Re,N as $e,O as He,Q as Be,U as E,W as qe}from"./react-efffxLy7.js";import{U as D,V as p,E as Ke,y as We}from"./vendor-DCPdCeUv.js";import{a as z,B as y,c as j,I as F,b as Z,d as T,C as B,e as q,f as K,g as W,s as Ge,h as Je,H as Qe}from"./card-DOCX8F0k.js";import{s as Xe,o as Ye,d as G,a as le,u as Ze,r as et,b as tt,e as st,f as ee,c as R,h as at,i as rt,q as nt,j as ot,g as lt,T as it}from"./firebase-Cj6kZwR2.js";import{L as ct,T as dt,a as ut,b as U,c as O}from"./label-Cs8jxQZa.js";import{u as mt,A as xt,G as ft,M as gt,I as ht}from"./google-maps-BCc-B1p4.js";import{m as pt,a as L,E as jt}from"./EventCard-CBNR4m3A.js";import"./shadcn-ui-BA32w1ww.js";import"./index-Ddg-2z5S.js";const vt=()=>{const t=ae();return{handleSignOut:async()=>{try{const s=await Xe(z);console.log(s),D.remove("auth_token"),t("/login")}catch(s){console.error("Error during sign out: ",s)}}}},bt=()=>{const{handleSignOut:t}=vt();return e.jsx(y,{onClick:t,children:"Log out"})},yt=ue,ie=m.createContext({}),k=({...t})=>e.jsx(ie.Provider,{value:{name:t.name},children:e.jsx(A,{...t})}),J=()=>{const t=m.useContext(ie),r=m.useContext(ce),{getFieldState:s}=H(),l=xe({name:t.name}),n=s(t.name,l);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:c}=r;return{id:c,name:t.name,formItemId:`${c}-form-item`,formDescriptionId:`${c}-form-item-description`,formMessageId:`${c}-form-item-message`,...n}},ce=m.createContext({});function w({className:t,...r}){const s=m.useId();return e.jsx(ce.Provider,{value:{id:s},children:e.jsx("div",{"data-slot":"form-item",className:j("grid gap-2",t),...r})})}function b({className:t,...r}){const{error:s,formItemId:l}=J();return e.jsx(ct,{"data-slot":"form-label","data-error":!!s,className:j("data-[error=true]:text-destructive",t),htmlFor:l,...r})}function S({...t}){const{error:r,formItemId:s,formDescriptionId:l,formMessageId:n}=J();return e.jsx(me,{"data-slot":"form-control",id:s,"aria-describedby":r?`${l} ${n}`:`${l}`,"aria-invalid":!!r,...t})}function C({className:t,...r}){const{error:s,formMessageId:l}=J(),n=s?String((s==null?void 0:s.message)??""):r.children;return n?e.jsx("p",{"data-slot":"form-message",id:l,className:j("text-destructive text-sm",t),...r,children:n}):null}function wt({className:t,...r}){return e.jsx("textarea",{"data-slot":"textarea",className:j("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...r})}const te=p.object({name:p.string(),percentage:p.number().max(100,"Percentage cannot exceed 100%")}),Nt=p.object({title:p.string().min(3,"Title is required"),startTime:p.date({required_error:"A start date and time is required"}),endTime:p.date({required_error:"An end date and time is required"}),price:p.number(),description:p.string().optional(),image:p.instanceof(File).optional(),link:p.string().optional(),music:p.array(p.string()).nonempty("Select at least one category"),musicPercentages:p.record(p.string(),te).and(p.object({others:te}).optional()).refine(t=>Object.values(t).reduce((r,s)=>r+s.percentage,0)<=100,{message:"Total music percentages cannot exceed 100%"}),location:p.object({propertyName:p.string().optional(),address:p.string().optional(),city:p.string().optional(),state:p.string().optional(),googleMapsUrl:p.string().optional(),lat:p.number().optional(),lng:p.number().optional()}).optional()}),St=({control:t,name:r})=>e.jsx(k,{control:t,name:r,render:({field:s})=>e.jsxs(w,{children:[e.jsx(b,{htmlFor:"imageUpload",children:"Upload Image"}),e.jsx(S,{children:e.jsx(Ct,{id:"imageUpload",value:s.value||void 0,onChange:s.onChange})}),e.jsx(C,{})]})}),Ct=({id:t,value:r,onChange:s})=>{const[l,n]=m.useState(null),c=m.useRef(null);m.useEffect(()=>{if(r instanceof File){const a=URL.createObjectURL(r);return n(a),()=>URL.revokeObjectURL(a)}else n(null)},[r]);const o=a=>{var f;const d=(f=a[0])==null?void 0:f.file;d instanceof File?s(d):(console.warn("Selected image is not a valid File object"),s(void 0))};return e.jsx(fe,{multiple:!1,value:r?[{file:r,data_url:l??""}]:[],onChange:o,dataURLKey:"data_url",children:({onImageUpload:a,onImageUpdate:d,onImageRemove:f,isDragging:x,dragProps:u})=>e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("input",{id:t,type:"file",ref:c,className:"hidden",onChange:i=>{var h;const g=(h=i.target.files)==null?void 0:h[0];g instanceof File&&s(g)}}),e.jsx(y,{type:"button",style:x?{backgroundColor:"limegreen",transition:"0.25s"}:void 0,onClick:a,...u,children:"Click or Drop image here"}),l&&e.jsxs("div",{children:[e.jsx("img",{src:l,alt:"event preview",className:"rounded-2xl"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(y,{type:"button",onClick:()=>d(0),children:"Update"}),e.jsx(y,{type:"button",onClick:()=>f(0),children:"Remove"})]})]})]})})},Pt=["places","marker"],_={lat:43.0722,lng:-89.4008},kt=({control:t,name:r})=>{const[s,l]=m.useState(null),[n,c]=m.useState(!1),[o,a]=m.useState(_),d=m.useRef(null),{isLoaded:f}=mt({googleMapsApiKey:"AIzaSyBuImOK6KWeeg3f71cgw6R-ssJj4arkAjk",libraries:Pt}),x=u=>{var N,P,Q,X,Y;if(!d.current)return;const i=d.current.getPlace();if(!((N=i.geometry)!=null&&N.location))return;const g=i.geometry.location.lat(),h=i.geometry.location.lng(),v={propertyName:i.name??"",address:i.formatted_address??"",city:(Q=(P=i.address_components)==null?void 0:P.find(I=>I.types.includes("locality")))==null?void 0:Q.long_name,state:(Y=(X=i.address_components)==null?void 0:X.find(I=>I.types.includes("administrative_area_level_1")))==null?void 0:Y.short_name,googleMapsUrl:i.url?i.url:`https://www.google.com/maps/search/?api=1&query=${g},${h}`,lat:g,lng:h};l(v),a({lat:g,lng:h}),u(v)};return f?e.jsx(k,{control:t,name:r,render:({field:u})=>e.jsxs(w,{children:[e.jsx(b,{htmlFor:r,children:"Event Location"}),e.jsx(S,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(xt,{onLoad:i=>d.current=i,onPlaceChanged:()=>x(u.onChange),children:e.jsx(F,{id:"location",placeholder:"Search for a location...",className:"w-full"})}),e.jsx("div",{className:"w-full h-72 rounded-md border",children:e.jsxs(ft,{center:o,zoom:15,mapContainerClassName:"w-full h-full rounded-2xl",options:pt,children:[s&&e.jsx(gt,{position:{lat:o.lat??_.lat,lng:o.lng??_.lng},onClick:()=>c(!0)}),s&&n&&e.jsx(ht,{position:{lat:o.lat??_.lat,lng:o.lng??_.lng},onCloseClick:()=>c(!1),children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h3",{className:"font-semibold text-md text-primary",children:s.propertyName}),e.jsx("p",{className:"text-sm text-gray-500",children:s.address}),s.city&&s.state&&e.jsxs("p",{className:"text-sm text-gray-400",children:[s.city,", ",s.state]}),e.jsx("a",{href:s.googleMapsUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary underline text-sm",children:"View on Google Maps"})]})})]})})]})}),e.jsx(C,{})]})}):e.jsx("p",{children:"Loading map..."})};function de({className:t,...r}){return e.jsx(ge,{"data-slot":"checkbox",className:j("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:e.jsx(he,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(re,{className:"size-3.5"})})})}const zt=({control:t,name:r})=>{const{field:{value:s,onChange:l}}=ne({name:r,control:t}),[n,c]=m.useState(s===0),o=d=>{const f=d.target.value?Number(d.target.value):0;l(f),f>0&&c(!1)},a=()=>{const d=!n;c(d),l(d?0:"")};return e.jsxs("div",{className:"space-y-2",children:[!n&&e.jsx(k,{control:t,name:r,render:()=>e.jsxs(w,{className:"text-start",children:[e.jsx(b,{htmlFor:"price",children:"Price"}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"pe-1",children:"$"}),e.jsx(F,{placeholder:"0",id:"price",type:"number",value:s||"",onChange:o})]})}),e.jsx(C,{})]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{id:"freeEvent",checked:n,onCheckedChange:a}),e.jsx("label",{htmlFor:"freeEvent",className:"px-1 text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"This is a free event"})]})]})},Ft=()=>{const{control:t,watch:r,setValue:s,trigger:l}=H(),n=r("music",["bachata","salsa"]),c=r("musicPercentages",{}),[o,a]=m.useState({}),[d,f]=m.useState(!1),x=m.useCallback(()=>{const u=Object.entries(c).filter(([g])=>g!=="others").reduce((g,[,h])=>g+((h==null?void 0:h.percentage)??0),0),i=Math.max(100-u,0);i>0?(s("musicPercentages.others",{name:"Others",percentage:i}),n.includes("others")||s("music",[...n,"others"])):(s("musicPercentages.others",{name:"Others",percentage:0}),n.includes("others")&&s("music",n.filter(g=>g!=="others"))),l("musicPercentages")},[c,n,s,l]);return m.useEffect(()=>{d||(n.forEach(u=>{var i;c[u]||s(`musicPercentages.${u}`,{name:((i=L.find(g=>g.id===u))==null?void 0:i.label)??u,percentage:u==="bachata"||u==="salsa"?50:0}),a(g=>({...g,[u]:`${u==="bachata"||u==="salsa"?50:0}`}))}),f(!0))},[n,c,s,d]),m.useEffect(()=>{Object.keys(c).filter(i=>i!=="others"&&!n.includes(i)).forEach(i=>{var g;s(`musicPercentages.${i}`,{name:((g=L.find(h=>h.id===i))==null?void 0:g.label)??i,percentage:0}),a(h=>({...h,[i]:"0"}))})},[n,c,s]),m.useEffect(()=>{x()},[c,x]),e.jsxs(w,{className:"space-y-2",children:[e.jsx(b,{children:"Music Breakdown"}),n.length===0?e.jsx("p",{className:"text-start text-sm text-gray-500",children:"No music categories selected"}):n.map(u=>{const i=L.find(g=>g.id===u);return i&&e.jsx(A,{control:t,name:`musicPercentages.${u}.percentage`,render:({field:g})=>e.jsxs(w,{className:"flex items-center justify-between gap-2",children:[e.jsx(b,{className:"w-1/3 text-sm font-medium",children:i.label}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(S,{children:e.jsx(F,{type:"number",value:o[u]??g.value??"",onChange:h=>{a(v=>({...v,[u]:h.target.value}))},onBlur:()=>{const h=o[u]?Number(o[u]):void 0;s(`musicPercentages.${u}.percentage`,h),x(),a(v=>{const N={...v};return delete N[u],N})},className:"flex grow"})}),e.jsx("span",{children:"%"})]})]})},u)}),n.includes("others")&&c.others&&e.jsx(A,{control:t,name:"musicPercentages.others.percentage",render:({field:u})=>e.jsxs(w,{className:"flex items-center justify-between gap-2",children:[e.jsx(b,{className:"w-1/3 text-sm font-medium",children:"Others"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(S,{children:e.jsx(F,{type:"number",value:o.others??u.value??"",onChange:i=>{a(g=>({...g,others:i.target.value}))},onBlur:()=>{const i=o.others?Number(o.others):void 0;s("musicPercentages.others.percentage",i),x(),a(g=>{const h={...g};return delete h.others,h})},className:"flex grow"})}),e.jsx("span",{children:"%"})]})]})},"others"),e.jsx(C,{})]})};function Tt({className:t,classNames:r,showOutsideDays:s=!0,...l}){return e.jsx(pe,{showOutsideDays:s,className:j("p-3",t),classNames:{months:"flex flex-col sm:flex-row gap-2",month:"flex flex-col gap-4",caption:"flex justify-center pt-1 relative items-center w-full",caption_label:"text-sm font-medium",nav:"flex items-center gap-1",nav_button:j(Z({variant:"outline"}),"size-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-x-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:j("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-range-end)]:rounded-r-md",l.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:j(Z({variant:"ghost"}),"size-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start aria-selected:bg-primary aria-selected:text-primary-foreground",day_range_end:"day-range-end aria-selected:bg-primary aria-selected:text-primary-foreground",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...r},components:{IconLeft:({className:n,...c})=>e.jsx(ve,{className:j("size-4",n),...c}),IconRight:({className:n,...c})=>e.jsx(je,{className:j("size-4",n),...c})},...l})}function Et({...t}){return e.jsx(be,{"data-slot":"popover",...t})}function _t({...t}){return e.jsx(ye,{"data-slot":"popover-trigger",...t})}function Lt({className:t,align:r="center",sideOffset:s=4,...l}){return e.jsx(we,{children:e.jsx(Ne,{"data-slot":"popover-content",align:r,sideOffset:s,className:j("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...l})})}function V({className:t,children:r,...s}){return e.jsxs(Se,{"data-slot":"scroll-area",className:j("relative",t),...s,children:[e.jsx(Ce,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:r}),e.jsx($,{}),e.jsx(Pe,{})]})}function $({className:t,orientation:r="vertical",...s}){return e.jsx(ke,{"data-slot":"scroll-area-scrollbar",orientation:r,className:j("flex touch-none p-px transition-colors select-none",r==="vertical"&&"h-full w-2.5 border-l border-l-transparent",r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",t),...s,children:e.jsx(ze,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function Mt({...t}){return e.jsx(Fe,{"data-slot":"select",...t})}function Dt({...t}){return e.jsx(_e,{"data-slot":"select-value",...t})}function It({className:t,size:r="default",children:s,...l}){return e.jsxs(Te,{"data-slot":"select-trigger","data-size":r,className:j("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...l,children:[s,e.jsx(Ee,{asChild:!0,children:e.jsx(oe,{className:"size-4 opacity-50"})})]})}function Ut({className:t,children:r,position:s="popper",...l}){return e.jsx(Le,{children:e.jsxs(Me,{"data-slot":"select-content",className:j("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...l,children:[e.jsx(Ot,{}),e.jsx(De,{className:j("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:r}),e.jsx(Vt,{})]})})}function M({className:t,children:r,...s}){return e.jsxs(Ie,{"data-slot":"select-item",className:j("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...s,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(Ue,{children:e.jsx(re,{className:"size-4"})})}),e.jsx(Oe,{children:r})]})}function Ot({className:t,...r}){return e.jsx(Ve,{"data-slot":"select-scroll-up-button",className:j("flex cursor-default items-center justify-center py-1",t),...r,children:e.jsx(Ae,{className:"size-4"})})}function Vt({className:t,...r}){return e.jsx(Re,{"data-slot":"select-scroll-down-button",className:j("flex cursor-default items-center justify-center py-1",t),...r,children:e.jsx(oe,{className:"size-4"})})}function se({form:t,label:r,formFieldName:s}){function l(o){o&&t.setValue(s,o)}function n(o){const a=We(new Date,parseInt(o)),d=t.getValues(s);d?a.setHours(d.getHours(),d.getMinutes(),d.getSeconds()):a.setHours(0,0,0,0),t.setValue(s,a)}function c(o,a){const d=t.getValues(s)||new Date,f=new Date(d);if(o==="hour"){const x=parseInt(a,10);f.getHours()>=12?f.setHours(x+12):f.setHours(x%12)}else if(o==="minute")f.setMinutes(parseInt(a,10));else if(o==="ampm"){const x=f.getHours();a==="AM"&&x>=12?f.setHours(x-12):a==="PM"&&x<12&&f.setHours(x+12)}t.setValue(s,f)}return e.jsx(k,{control:t.control,name:s,render:({field:o})=>e.jsxs(w,{className:"flex flex-col text-start",children:[e.jsx(b,{children:r}),e.jsxs(Et,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(S,{children:e.jsxs(y,{variant:"outline",className:j("w-full pl-3 text-left font-normal",!o.value&&"text-muted-foreground"),children:[o.value?Ke(o.value,"MM/dd/yyyy hh:mm aa"):e.jsx("span",{children:"Select date and time"}),e.jsx($e,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(Lt,{className:"w-auto p-2",children:e.jsxs("div",{className:"flex-col sm:flex",children:[e.jsx("div",{children:e.jsxs(Mt,{onValueChange:n,children:[e.jsx(It,{children:e.jsx(Dt,{placeholder:"Select"})}),e.jsxs(Ut,{position:"popper",children:[e.jsx(M,{value:"0",children:"Today"}),e.jsx(M,{value:"1",children:"Tomorrow"}),e.jsx(M,{value:"3",children:"In 3 days"}),e.jsx(M,{value:"7",children:"In a week"})]})]})}),e.jsxs("div",{className:"sm:flex",children:[e.jsx(Tt,{mode:"single",selected:o.value,onSelect:l,initialFocus:!0}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:h-[300px] divide-y sm:divide-y-0 sm:divide-x",children:[e.jsxs(V,{className:"w-64 sm:w-auto",children:[e.jsx("div",{className:"flex sm:flex-col p-2",children:Array.from({length:12},(a,d)=>d+1).reverse().map(a=>e.jsx(y,{size:"icon",variant:o.value&&o.value.getHours()%12===a%12?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>c("hour",a.toString()),children:a},a))}),e.jsx($,{orientation:"horizontal",className:"sm:hidden"})]}),e.jsxs(V,{className:"w-64 sm:w-auto",children:[e.jsx("div",{className:"flex sm:flex-col p-2",children:Array.from({length:12},(a,d)=>d*5).map(a=>e.jsx(y,{size:"icon",variant:o.value&&o.value.getMinutes()===a?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>c("minute",a.toString()),children:a.toString().padStart(2,"0")},a))}),e.jsx($,{orientation:"horizontal",className:"sm:hidden"})]}),e.jsx(V,{className:"",children:e.jsx("div",{className:"flex sm:flex-col p-2",children:["AM","PM"].map(a=>e.jsx(y,{size:"icon",variant:o.value&&(a==="AM"&&o.value.getHours()<12||a==="PM"&&o.value.getHours()>=12)?"default":"ghost",className:"sm:w-full shrink-0 aspect-square",onClick:()=>c("ampm",a),children:a},a))})})]})]})]})})]}),e.jsx(C,{})]})})}const At=({control:t,name:r})=>{const{getValues:s,setValue:l}=H(),{field:{value:n,onChange:c}}=ne({name:r,control:t}),o=(a,d)=>{const f=a?[...n||[],d]:(n==null?void 0:n.filter(x=>x!==d))||[];if(c(f),!a){const x=s("musicPercentages")||{},u=Object.fromEntries(Object.entries(x).filter(([i])=>i!==d));l("musicPercentages",u)}};return e.jsxs(w,{children:[e.jsx(b,{children:"Music"}),L.map(a=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{id:a.id,checked:n==null?void 0:n.includes(a.id),onCheckedChange:d=>o(!!d,a.id)}),e.jsx(b,{htmlFor:a.id,className:"text-sm font-normal",children:a.label})]},a.id)),e.jsx(C,{})]})},Rt=()=>{const[t,r]=m.useState(!0),[s,l]=m.useState(null),[n,c]=m.useState(null);return m.useEffect(()=>{if(D.get("auth_token")){const a=Ye(z,async d=>{if(d){const f=G(T,"organizers",d.uid),x=await le(f);x.exists()?c(x.data()):l("No organizer data found")}else l("User not authenticated");r(!1)});return()=>a()}else r(!1),l("No authentication token found. Please log in")},[]),{loading:t,error:s,profileData:n}},$t=()=>{const[t,r]=m.useState(null),[s,l]=m.useState(!0);return m.useEffect(()=>{(async()=>{const c=z.currentUser;if(!c){l(!1);return}try{const o=G(T,"organizers",c.uid),a=await le(o);if(a.exists()){const d=a.data();r((d==null?void 0:d.socialMediaLink)??null)}}catch(o){console.warn("Could not fetch organizer social link:",o)}finally{l(!1)}})()},[]),{socialLink:t,loading:s}},Ht=()=>{const[t,r]=m.useState(!1),[s,l]=m.useState(null),[n,c]=m.useState(!1);return{loading:t,error:s,success:n,updateProfile:async a=>{var f;if(r(!0),l(null),c(!1),D.get("auth_token"))try{await((f=z.currentUser)==null?void 0:f.getIdToken(!0));const x=z.currentUser;if(x){const u=G(T,"organizers",x.uid);await Ze(u,a),c(!0)}else l("User not authenticated")}catch(x){console.error("Error updating profile:",x),l("Failed to update profile. Please try again.")}finally{r(!1)}else r(!1),l("No authentication token found. Please log in again.")}}},Bt=({className:t,...r})=>{const[s,l]=m.useState(!1),n=He({resolver:Be(Nt),defaultValues:{music:["bachata","salsa"],location:{},musicPercentages:{...Object.fromEntries(L.map(a=>[a.id,{name:a.label,percentage:a.id==="bachata"||a.id==="salsa"?50:0}])),others:{name:"Others",percentage:0}}}}),{socialLink:c}=$t(),o=async a=>{var u;l(!0);let d="";const f=z.currentUser;if(!f){console.error("User not authenticated"),l(!1);return}try{if(a.image instanceof File){const i=et(Ge,`events/${Date.now()}-${a.image.name}`);await tt(i,a.image),d=await st(i)}}catch(i){console.error("Image upload failed:",i),l(!1);return}const x={title:a.title,startTime:a.startTime,endTime:a.endTime,imageUrl:d,description:(u=a.description)==null?void 0:u.trim(),price:a.price,music:a.music,musicPercentages:a.musicPercentages,location:a.location,link:a.link,organizerId:f.uid,organizerSocialLink:c,createdAt:at()};try{await ee(R(T,"organizers",f.uid,"events"),x),await ee(R(T,"events"),x),console.log("Event successfully created in both collections!")}catch(i){console.error("Firestore error:",i),alert("There was an error saving your event. Please try again.")}l(!1)};return e.jsx("div",{className:j("w-full flex flex-col gap-6 m-2",t),...r,children:e.jsxs(B,{children:[e.jsx(q,{children:e.jsx(K,{className:"text-2xl",children:"Create Event"})}),e.jsx(W,{children:e.jsx(yt,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(o),className:"flex flex-col justify-center py-2 gap-4",children:[e.jsx(k,{control:n.control,name:"title",render:({field:a})=>e.jsxs(w,{className:"text-start",children:[e.jsx(b,{htmlFor:"title",children:"Title"}),e.jsx(S,{children:e.jsx(F,{id:"title",placeholder:"Dance Social",...a})}),e.jsx(C,{})]})}),e.jsx(kt,{control:n.control,name:"location"}),e.jsx(se,{form:n,label:"Start time",formFieldName:"startTime"}),e.jsx(se,{form:n,label:"End time",formFieldName:"endTime"}),e.jsx(St,{control:n.control,name:"image"}),e.jsx(k,{control:n.control,name:"description",render:({field:a})=>e.jsxs(w,{children:[e.jsx(b,{children:"Description"}),e.jsx(S,{children:e.jsx(wt,{...a})}),e.jsx(C,{})]})}),e.jsx(zt,{control:n.control,name:"price"}),e.jsx(At,{control:n.control,name:"music"}),e.jsx(Ft,{}),e.jsx(k,{control:n.control,name:"link",render:({field:a})=>e.jsxs(w,{children:[e.jsx(b,{children:"Link"}),e.jsx(S,{children:e.jsx(F,{placeholder:"event link (optional)","aria-label":"link for additional details",...a})}),e.jsx(C,{})]})}),e.jsx(y,{type:"submit",disabled:s||!n.formState.isValid,children:s?"Submitting...":"Post Event"})]})})})]})})},qt=()=>{const[t]=rt(z),[r,s]=m.useState([]),[l,n]=m.useState(!0);return m.useEffect(()=>{if(!t)return;(async()=>{try{const o=R(T,`organizers/${t.uid}/events`),a=nt(o,ot("endTime","desc")),f=(await lt(a)).docs.map(x=>{const u=x.data();return{id:x.id,...u,createdAt:u.createdAt.toDate(),startTime:u.startTime.toDate(),endTime:u.endTime.toDate()}});s(f)}catch(o){console.error("Error fetching previous posts:",o)}finally{n(!1)}})()},[t]),t?l?e.jsx("p",{children:"Loading previous posts..."}):e.jsx("div",{className:"flex flex-col",children:r.map(c=>e.jsx(jt,{social:c},c.id))}):e.jsx("p",{children:"Please log in to view your previous posts."})},Kt=()=>{const[t,r]=m.useState(!0),[s,l]=m.useState([]),{loading:n,error:c,profileData:o}=Rt(),{loading:a,error:d,success:f,updateProfile:x}=Ht();m.useEffect(()=>{o&&l([{label:"Email",value:o.email},{label:"First name",value:o.firstName||""},{label:"Last name",value:o.lastName||""},{label:"Social Media",value:o.socialMediaLink??""},{label:"Website",value:o.websiteLink??""}])},[o]);const u=async()=>{if(!o){E.error("Profile data not found");return}const i={"First name":"firstName","Last name":"lastName","Social Media":"socialMediaLink",Website:"websiteLink"},g=s.reduce((v,N)=>{const P=i[N.label];return P&&N.value&&(P==="createdAt"?v[P]=it.fromDate(new Date(N.value)):v[P]=N.value),v},{});if(!Object.keys(g).some(v=>g[v]!==o[v])){E("No changes detected. Profile not updated");return}await x(g),f&&E.success("Successfully updated your profile"),d&&E.error("An error occured while updating profile, please try again"),r(!0)};if(n)return e.jsx("div",{children:e.jsx("p",{children:"Profile loading..."})});if(c){E.error(c);return}return e.jsxs("div",{className:"flex flex-col items-center mt-4",children:[e.jsx(qe,{richColors:!0,position:"top-center",className:"text-start"}),e.jsx("div",{children:e.jsxs(B,{className:"md:w-[450px]",children:[e.jsx(q,{children:e.jsx(K,{children:"Profile"})}),e.jsx(W,{children:e.jsx("ul",{className:"flex-col mt-4",children:s.map((i,g)=>e.jsxs("li",{className:"flex gap-1 items-center text-start mb-2 justify-between",children:[e.jsx("label",{className:"w-1/4",children:i.label}),e.jsx(F,{value:i.value,onChange:h=>{const v=[...s];v[g].value=h.target.value,l(v)},disabled:i.label==="Email"||t,className:"w-3/4"})]},i.label))})}),e.jsxs(Je,{className:"flex justify-between",children:[e.jsx(y,{variant:"link",onClick:()=>{r(!t)},disabled:!t,children:"Edit Profile"}),e.jsx(y,{onClick:u,disabled:a||t,variant:t?"outline":"default",children:"Update Profile"})]})]})})]})},Wt=({className:t,...r})=>e.jsx("div",{className:j("flex flex-col gap-6 m-2",t),...r,children:e.jsxs(B,{className:"min-h-svh",children:[e.jsx(q,{children:e.jsx(K,{className:"text-2xl",children:"Organizer Dashboard"})}),e.jsx(W,{children:e.jsx("div",{className:"flex min-h-full w-full justify-center px-0 sm:px-8",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs(dt,{defaultValue:"create-post",className:"w-full",children:[e.jsxs(ut,{className:"grid w-full grid-cols-3",children:[e.jsx(U,{value:"create-post",children:"Create Post"}),e.jsx(U,{value:"post",children:"Posts"}),e.jsx(U,{value:"profile",children:"Profile"})]}),e.jsx(O,{value:"create-post",className:"flex",children:e.jsx(Bt,{})}),e.jsx(O,{value:"post",children:e.jsx(qt,{})}),e.jsx(O,{value:"profile",children:e.jsx(Kt,{})})]})})})})]})});function as(){const t=ae();return m.useEffect(()=>{const r=D.get("auth_token");r?r===void 0&&t("/"):t("/login")},[t]),e.jsxs("div",{children:[e.jsx(Qe,{}),e.jsx(Wt,{}),e.jsx(bt,{})]})}export{as as default};
